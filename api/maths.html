<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Maths &mdash; PyhDToolkit 1.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.4b15212bc2faf4da239d738a7cf8e545.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="Cpymadtools" href="cpymadtools.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyhDToolkit
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#using-with-docker">Using With Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#minutes-to-pyhdtoolkit">5 Minutes to PyhDToolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#cpymadtools">Cpymadtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#plotting">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#utilities">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#additional-helpers">Additional Helpers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_acd_tracking_spectra.html">AC Dipole Driven Tracking Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_aperture.html">Accelerator Aperture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lattice.html">Accelerator Lattice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_beam_enveloppe.html">Beam Enveloppe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_stats_fitting.html">Distributions Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_track_spectra.html">Free Tracking Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lhc_crossing_schemes.html">LHC Crossing Schemes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_ir_errors.html">LHC IR Errors Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html">LHC Rigid Waist Shift</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html#showcasing-the-waist-shift">Showcasing the Waist Shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html#determining-the-waist-shift">Determining the Waist Shift</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_machine_survey.html">Machine Survey</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_phase_space.html">Phase Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_sbs_plotting.html">Segment-by-Segment Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_tune_diagram.html">Tune Diagram</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cpymadtools.html">Cpymadtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#useful-constants">Useful Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#betatron-coupling-utilities">Betatron Coupling Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#lhc-specific-utilities">LHC-Specific Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#matching-routines">Matching Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#ptc-routines">PTC Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#tracking-routines">Tracking Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#tune-utilities">Tune Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#twiss-routines">TWISS Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="cpymadtools.html#miscellaneous-utilities">Miscellaneous Utilities</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Maths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nonconvex-phase-synchronization">Nonconvex Phase Synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stats-fitting">Stats Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="models.html#particle-beam-models">Particle Beam Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#htcondor-models">HTCondor Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#mad-x-models">MAD-X Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optics.html">Optics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optics.html#beam-optics">Beam Optics</a></li>
<li class="toctree-l3"><a class="reference internal" href="optics.html#ripken-parameters">Ripken Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="optics.html#twiss-optics">Twiss Optics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#plotting-styles">Plotting Styles</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#paper-styles">Paper Styles</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#thesis-styles">Thesis Styles</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#aperture-plotters">Aperture Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#crossing-scheme-plotters">Crossing Scheme Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#beam-enveloppe-plotters">Beam Enveloppe Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#lattice-plotters">Lattice Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#layout-plotters">Layout Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#phase-space-plotters">Phase Space Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#tune-diagram-plotters">Tune Diagram Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#segment-by-segment-coupling">Segment-by-Segment Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#segment-by-segment-phase">Segment-by-Segment Phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#plotting-utility-functions">Plotting Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#command-line-utilities">Command Line Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#context-utilities">Context Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#executors-utilities">Executors Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#htcondor-monitoring">HTCondor Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#logging-utilities">Logging Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#miscellanous-personnal-utilities">Miscellanous Personnal Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#operations-utilities">Operations Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#printing-utilities">Printing Utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#asking-for-help">Asking for Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#bug-reports">Bug Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#enhancement-proposals">Enhancement Proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-code-and-or-documentation">Contributing Code and/or Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#forking-the-repository">Forking the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#creating-a-development-environment">Creating a Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#creating-a-branch">Creating a Branch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#running-the-test-suite">Running the Test Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#code-standards">Code Standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#documentation">Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-1-1-1">Version 1.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v1.1.1.html">1.1.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-1-1-0">Version 1.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v1.1.0.html">1.1.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-1-0-0">Version 1.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v1.0.0.html">1.0.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-21-0">Version 0.21.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.21.0.html">0.21.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-20-1">Version 0.20.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.20.1.html">0.20.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-20-0">Version 0.20.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.20.0.html">0.20.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-19-1">Version 0.19.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.19.1.html">0.19.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-19-0">Version 0.19.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.19.0.html">0.19.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-18-0">Version 0.18.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.18.0.html">0.18.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-17-0">Version 0.17.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.17.0.html">0.17.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-16-1">Version 0.16.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.16.1.html">0.16.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-16-0">Version 0.16.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.16.0.html">0.16.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-15-1">Version 0.15.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.15.1.html">0.15.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-15-0">Version 0.15.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.15.0.html">0.15.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-14-1">Version 0.14.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.14.1.html">0.14.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-14-0">Version 0.14.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.14.0.html">0.14.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-3">Version 0.13.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.3.html">0.13.3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-2">Version 0.13.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.2.html">0.13.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-1">Version 0.13.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.1.html">0.13.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-0">Version 0.13.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.0.html">0.13.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-12-0">Version 0.12.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.12.0.html">0.12.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-11-0">Version 0.11.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.11.0.html">0.11.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-10-0">Version 0.10.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.10.0.html">0.10.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-2">Version 0.9.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.2.html">0.9.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-1">Version 0.9.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.1.html">0.9.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-0">Version 0.9.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.0.html">0.9.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-5">Version 0.8.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.5.html">0.8.5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-4">Version 0.8.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.4.html">0.8.4</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-3">Version 0.8.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.3.html">0.8.3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-2">Version 0.8.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.2.html">0.8.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-1">Version 0.8.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.1.html">0.8.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-0">Version 0.8.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.0.html">0.8.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-7-0">Version 0.7.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.7.0.html">0.7.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-6-0">Version 0.6.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.6.0.html">0.6.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-5-0">Version 0.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html">0.5.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-4-1">Version 0.4.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.4.1.html">0.4.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-4-0">Version 0.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.4.0.html">0.4.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-3-0">Version 0.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.3.0.html">0.3.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-2-1">Version 0.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.2.1.html">0.2.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-2-0">Version 0.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.2.0.html">0.2.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Reference bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyhDToolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Reference</a></li>
      <li class="breadcrumb-item active">Maths</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/fsoubelet/PyhDToolkit" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pyhdtoolkit.maths.nonconvex_phase_sync">
<span id="maths"></span><span id="pyhdtoolkit-maths"></span><h1>Maths<a class="headerlink" href="#module-pyhdtoolkit.maths.nonconvex_phase_sync" title="Permalink to this headline"></a></h1>
<section id="nonconvex-phase-synchronization">
<span id="maths-nonconvex-phase-sync"></span><h2>Nonconvex Phase Synchronization<a class="headerlink" href="#nonconvex-phase-synchronization" title="Permalink to this headline"></a></h2>
<p>This is a Python3 implementation of the Nonconvex Phase Synchronisation method found in <span id="id1">Boumal [<a class="reference internal" href="../bibliography.html#id2" title="Nicolas Boumal. Nonconvex phase synchronization. SIAM Journal on Optimization, 26(4):2355–2377, 2016. URL: https://doi.org/10.1137/16M105808X, doi:10.1137/16M105808X.">Bou16</a>]</span>, page 8.</p>
<section id="methodology-and-use-case">
<h3>Methodology and Use Case:<a class="headerlink" href="#methodology-and-use-case" title="Permalink to this headline"></a></h3>
<p>We consider that from measurements, we can only obtain noisy relative phase advances
<span class="math notranslate nohighlight">\(\mu_{i} - \mu_{j}\)</span> and want a converging solution to reconstruct the different individual
<span class="math notranslate nohighlight">\(\mu_{1}, ...., \mu_{n}\)</span> values.</p>
<p>From measurements, we construct a hermitian matrix C in the shape of:</p>
<div class="math notranslate nohighlight">
\[C_{ij} = z_{i} \bar{z}_{j} = e^{i (\mu_{i} - \mu_{j})}\]</div>
<p>A mock one with random values (500 by 500 as we have 500 BPMs per plane in the LHC) would be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">))</span>
</pre></div>
</div>
<p>Considering 4 BPMs, the measurement matrix would be:</p>
<div class="math notranslate nohighlight">
\[\begin{split}M = \begin{pmatrix}
       \mu_{1 -&gt; 1} &amp; \mu_{1 -&gt; 2} &amp; \mu_{1 -&gt; 3} &amp; \mu_{1 -&gt; 4} \\
       \mu_{2 -&gt; 1} &amp; \mu_{2 -&gt; 2} &amp; \mu_{2 -&gt; 3} &amp; \mu_{2 -&gt; 4} \\
       \mu_{3 -&gt; 1} &amp; \mu_{3 -&gt; 2} &amp; \mu_{3 -&gt; 3} &amp; \mu_{3 -&gt; 4} \\
       \mu_{4 -&gt; 1} &amp; \mu_{4 -&gt; 2} &amp; \mu_{4 -&gt; 3} &amp; \mu_{4 -&gt; 4}
    \end{pmatrix}\end{split}\]</div>
<dl class="simple">
<dt>Note two particular properties here:</dt><dd><ul class="simple">
<li><p>Because our measurements are phase differences, the <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> will necessarily have zeros on
its diagonal (<span class="math notranslate nohighlight">\(\mu_{k -&gt; k} = 0\)</span>).</p></li>
<li><p>By definition, since <span class="math notranslate nohighlight">\(\mu_{a -&gt; b} = - \mu_{b -&gt; a}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> is symmetric.</p></li>
<li><p>Also note that for all computations, <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> needs to be initialised in radians!</p></li>
</ul>
</dd>
</dl>
<p>We can very simply get our C_matrix (see page 1 of referenced paper) with <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.exp.html#numpy.exp" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.exp</span></code></a> which,
applied to a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> applies the exponential function element-wise.</p>
<p>Then follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">M_matrix</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> is symmetric, then C_matrix will be Hermitian.
Since <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> has zeros on its diagonal, C_matrix will have (1 + 0j) on its diagonal.</p>
</div>
<p>With added noise to those values (noise should be included in <span class="math notranslate nohighlight">\(\mathrm{M_matrix}\)</span> in the case of measurements),
we can reconstruct a good estimator of the original values through the EVM method, provided in the
class below.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.nonconvex_phase_sync.</span></span><span class="sig-name descname"><span class="pre">PhaseReconstructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurements_hermitian_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/nonconvex_phase_sync.html#PhaseReconstructor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.4.0.</span></p>
</div>
<p>Class algorithm to reconstruct your phase values.
Make sure to provide vectors as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape (1, N), N being the dimension.</p>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">real_noised_measurements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C_herm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">RealNoisedMeas</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pr</span> <span class="o">=</span> <span class="n">PhaseReconstructor</span><span class="p">(</span><span class="n">C_herm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_eigenvector_method_result</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">get_eigenvector_estimator</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pr</span><span class="o">.</span><span class="n">leading_eigenvector</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reconstructed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">pr</span><span class="o">.</span><span class="n">convert_complex_result_to_phase_values</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">complex_eigenvector_method_result</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span>    <span class="p">)</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n_observation_points</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurements_hermitian_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/nonconvex_phase_sync.html#PhaseReconstructor.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialize your reconstructor object from measurements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>measurements_hermitian_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) -- a 2D array built from measurements, see
module docstring on how to build this matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.alpha">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">alpha</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.float64</span></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.alpha" title="Permalink to this definition"></a></dt>
<dd><p>Factor used to define the new reconstruction matrix. It is taken either as the
operator norm of the hermitian noise matrix C_matrix, or as the max value between
0 and the opposite of the min eigenvalue of C_matrix (chosen for implementation,
since our noise is included in the measurements). See page 8 of the paper for
reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A real scalar value, since C_matrix is Hermitian and the eigenvalues of real
symmetric or complex Hermitian matrices are always real (see <span id="id2">Strang [<a class="reference internal" href="../bibliography.html#id7" title="G. Strang. Linear Algebra and Its Applications. Academic Press, Inc., Orlando, FL, 1980. ISBN 0534422004.">Str80</a>]</span>,
page 222).</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix">
<span class="sig-name descname"><span class="pre">c_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Hermitian square matrix from your measurements</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix_eigenvalues">
<span class="sig-name descname"><span class="pre">c_matrix_eigenvalues</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix_eigenvalues" title="Permalink to this definition"></a></dt>
<dd><p>Eigenvalues of c_matrix</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix_eigenvectors">
<span class="sig-name descname"><span class="pre">c_matrix_eigenvectors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.c_matrix_eigenvectors" title="Permalink to this definition"></a></dt>
<dd><p>Eigenvectors of c_matrix</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.convert_complex_result_to_phase_values">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_complex_result_to_phase_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">complex_estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/nonconvex_phase_sync.html#PhaseReconstructor.convert_complex_result_to_phase_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.convert_complex_result_to_phase_values" title="Permalink to this definition"></a></dt>
<dd><p>Casts back the complex form of your result to real phase values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>complex_estimator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) -- your reconstructed result’s complex form as a
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if this is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the result is cast to degrees (from radians)
before being returned. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with the real phase values of the result.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.get_eigenvector_estimator">
<span class="sig-name descname"><span class="pre">get_eigenvector_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenvector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/nonconvex_phase_sync.html#PhaseReconstructor.get_eigenvector_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.get_eigenvector_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Return the eigenvector estimator of a given eigenvector (id est the component-wise
projection of said eigenvector onto <span class="math notranslate nohighlight">\(\mathbb{C}_1\)</span>. See page 7 of
<span id="id3">Boumal [<a class="reference internal" href="../bibliography.html#id2" title="Nicolas Boumal. Nonconvex phase synchronization. SIAM Journal on Optimization, 26(4):2355–2377, 2016. URL: https://doi.org/10.1137/16M105808X, doi:10.1137/16M105808X.">Bou16</a>]</span> for the implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eigenvector</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) -- a numpy array representing the vector.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> object of the same dimension as <em>eigenvector</em>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.leading_eigenvector">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">leading_eigenvector</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.leading_eigenvector" title="Permalink to this definition"></a></dt>
<dd><p>Returns the leading eigenvector of <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.c_matrix</span></code>, which is the eigenvector corresponding
to the max eigenvalue (in absolute value).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> object, corresponding to said eigenvector.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.reconstruct_complex_phases_evm">
<span class="sig-name descname"><span class="pre">reconstruct_complex_phases_evm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/nonconvex_phase_sync.html#PhaseReconstructor.reconstruct_complex_phases_evm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.reconstruct_complex_phases_evm" title="Permalink to this definition"></a></dt>
<dd><p>Reconstructs the simplest estimator fom the eigenvector method. The
result is in complex form, and will be radians once cast back to real
form.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The complex form of the result as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.reconstructor_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reconstructor_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.reconstructor_matrix" title="Permalink to this definition"></a></dt>
<dd><p>This is the reconstructor matrix built from <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.c_matrix</span></code> and the <a class="reference internal" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.alpha" title="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.alpha"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha</span></code></a> property.
It is the matrix denoted as <span class="math notranslate nohighlight">\(\widetilde{C}\)</span> on page 8 of <span id="id4">Boumal [<a class="reference internal" href="../bibliography.html#id2" title="Nicolas Boumal. Nonconvex phase synchronization. SIAM Journal on Optimization, 26(4):2355–2377, 2016. URL: https://doi.org/10.1137/16M105808X, doi:10.1137/16M105808X.">Bou16</a>]</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, with same dimension as <code class="xref py py-obj docutils literal notranslate"><span class="pre">self.c_matrix</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.space_dimension">
<span class="sig-name descname"><span class="pre">space_dimension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></em><a class="headerlink" href="#pyhdtoolkit.maths.nonconvex_phase_sync.PhaseReconstructor.space_dimension" title="Permalink to this definition"></a></dt>
<dd><p>Dimension of your measurement space</p>
</dd></dl>

</dd></dl>

</section>
</section>
<span class="target" id="module-pyhdtoolkit.maths.stats_fitting"></span><section id="stats-fitting">
<span id="maths-stats-fitting"></span><h2>Stats Fitting<a class="headerlink" href="#stats-fitting" title="Permalink to this headline"></a></h2>
<p>Module implementing methods to find the best fit of statistical distributions to data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.stats_fitting.best_fit_distribution">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.stats_fitting.</span></span><span class="sig-name descname"><span class="pre">best_fit_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.5.2)"><span class="pre">pandas.core.series.Series</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://matplotlib.org/stable/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.6.2)"><span class="pre">matplotlib.axes._axes.Axes</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous" title="(in SciPy v1.9.3)"><span class="pre">scipy.stats._distn_infrastructure.rv_continuous</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/stats_fitting.html#best_fit_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.stats_fitting.best_fit_distribution" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.5.0.</span></p>
</div>
<p>Model data by finding the best fit candidate distribution among those in <code class="docutils literal notranslate"><span class="pre">DISTRIBUTIONS</span></code>.
One can find an example use of this function in the <a class="reference internal" href="../gallery/demo_stats_fitting.html#demo-distributions-fitting"><span class="std std-ref">gallery</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[pd.Series,</span> <span class="pre">np.ndarray]</span></code>) -- a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.Series</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with your
distribution data.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of bins to decompose your data in before fitting.</p></li>
<li><p><strong>ax</strong> (<a class="reference external" href="https://matplotlib.org/stable/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.6.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a>) -- the <a class="reference external" href="https://matplotlib.org/stable/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.6.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> on which to plot the probability
density function of the different fitted distributions. This should be provided as
the axis on which the distribution data is plotted, as it will add to that plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> containing the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> generator corresponding to the best fit candidate,
and the parameters for said generator to best fit the data.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">best_fit_func</span><span class="p">,</span> <span class="n">best_fit_params</span> <span class="o">=</span> <span class="n">best_fit_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.stats_fitting.make_pdf">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.stats_fitting.</span></span><span class="sig-name descname"><span class="pre">make_pdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous" title="(in SciPy v1.9.3)"><span class="pre">scipy.stats._distn_infrastructure.rv_continuous</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">25000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.5.2)"><span class="pre">pandas.core.series.Series</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/stats_fitting.html#make_pdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.stats_fitting.make_pdf" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.5.0.</span></p>
</div>
<p>Generates a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.Series</span></code></a> for the distributions’s Probability Distribution Function.
This Series will have axis values as index, and PDF values as column. One can find an
example use of this function in the <a class="reference internal" href="../gallery/demo_stats_fitting.html#demo-distributions-fitting"><span class="std std-ref">gallery</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distribution</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">st.rv_continuous</span></code>) -- a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> generator.</p></li>
<li><p><strong>params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">...]</span></code>) -- the parameters for this generator given back by the fit.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of points to evaluate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.Series</span></code></a> with the PDF as values, and the corresponding axis values as index.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">best_fit_func</span><span class="p">,</span> <span class="n">best_fit_params</span> <span class="o">=</span> <span class="n">best_fit_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">fitting</span><span class="o">.</span><span class="n">make_pdf</span><span class="p">(</span><span class="n">best_fit_func</span><span class="p">,</span> <span class="n">best_fit_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.stats_fitting.set_distributions_dict">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.stats_fitting.</span></span><span class="sig-name descname"><span class="pre">set_distributions_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html#scipy.stats.rv_continuous" title="(in SciPy v1.9.3)"><span class="pre">scipy.stats._distn_infrastructure.rv_continuous</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/stats_fitting.html#set_distributions_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.stats_fitting.set_distributions_dict" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.5.0.</span></p>
</div>
<p>Sets <code class="docutils literal notranslate"><span class="pre">DISTRIBUTIONS</span></code> as the provided <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>. This allows the user to define the
distributions to try and fit against the data. One can find an example use of this
function in the <a class="reference internal" href="../gallery/demo_stats_fitting.html#demo-distributions-fitting"><span class="std std-ref">gallery</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict[st.rv_continuous,</span> <span class="pre">str]</span></code>) -- dictionnary with the wanted distributions,
in the format of <code class="docutils literal notranslate"><span class="pre">DISTRIBUTIONS</span></code>, aka with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v1.9.3)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.stats</span></code></a> generator objects as
keys, and a string representation of their name as value.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing, but modifies the global <code class="docutils literal notranslate"><span class="pre">DISTRIBUTIONS</span></code> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> called by other functions.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tested_dists</span> <span class="o">=</span> <span class="p">{</span><span class="n">st</span><span class="o">.</span><span class="n">chi</span><span class="p">:</span> <span class="s2">&quot;Chi&quot;</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">expon</span><span class="p">:</span> <span class="s2">&quot;Exponential&quot;</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">laplace</span><span class="p">:</span> <span class="s2">&quot;Laplace&quot;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_distributions_dict</span><span class="p">(</span><span class="n">tested_dists</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.maths.utils"></span><section id="utilities">
<span id="maths-utils"></span><h2>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline"></a></h2>
<p>Module with utility functions used throughout the <a class="reference internal" href="#module-pyhdtoolkit.maths.nonconvex_phase_sync" title="pyhdtoolkit.maths.nonconvex_phase_sync"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nonconvex_phase_sync</span></code></a> and <a class="reference internal" href="#module-pyhdtoolkit.maths.stats_fitting" title="pyhdtoolkit.maths.stats_fitting"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats_fitting</span></code></a> modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.utils.get_magnitude">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.utils.</span></span><span class="sig-name descname"><span class="pre">get_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/utils.html#get_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.utils.get_magnitude" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.2.</span></p>
</div>
<p>Returns the determined magnitude of the provided <em>value</em>. This corresponds to the
power of 10 that would be necessary to reduce <em>value</em> to a <span class="math notranslate nohighlight">\(X \cdot 10^{n}\)</span>
form. In this case, <em>n</em> is the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- value to determine the magnitude of.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The magnitude of the provided <em>value</em>, as an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>.</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_magnitude</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_magnitude</span><span class="p">(</span><span class="mf">0.0311</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_magnitude</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">)</span>
<span class="go">-7</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.maths.utils.get_scaled_values_and_magnitude_string">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.maths.utils.</span></span><span class="sig-name descname"><span class="pre">get_scaled_values_and_magnitude_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.2)"><span class="pre">pandas.core.frame.DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_magnitude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.2)"><span class="pre">pandas.core.frame.DataFrame</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/maths/utils.html#get_scaled_values_and_magnitude_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.maths.utils.get_scaled_values_and_magnitude_string" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.2.</span></p>
</div>
<p>Conveniently scales the provided values to the best determined magnitude, and returns
the scaled values and the magnitude string to use in plots labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values_array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[pd.DataFrame,</span> <span class="pre">np.ndarray]</span></code>) -- vectorised structure containing the
values to scale.</p></li>
<li><p><strong>force_magnitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- a specific magnitude value to use for the scaling, if desired.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of the scaled values (same type as the provided ones) and the string to use for
the scale in plots labels and legends.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">330</span><span class="p">,</span>  <span class="mi">230</span><span class="p">,</span>  <span class="mi">430</span><span class="p">,</span> <span class="o">-</span><span class="mi">720</span><span class="p">,</span>  <span class="mi">750</span><span class="p">,</span> <span class="o">-</span><span class="mi">110</span><span class="p">,</span>  <span class="mi">410</span><span class="p">,</span> <span class="o">-</span><span class="mi">340</span><span class="p">,</span> <span class="o">-</span><span class="mi">950</span><span class="p">,</span> <span class="o">-</span><span class="mi">630</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_scaled_values_and_magnitude_string</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">(array([-3.3,  2.3,  4.3, -7.2,  7.5, -1.1,  4.1, -3.4, -9.5, -6.3]), &#39;{-2}&#39;)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cpymadtools.html" class="btn btn-neutral float-left" title="Cpymadtools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="models.html" class="btn btn-neutral float-right" title="Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Felix Soubelet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: 67.5%; }
  </style>



</body>
</html>