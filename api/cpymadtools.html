<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cpymadtools &mdash; PyhDToolkit 1.0.0rc0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../_static/panels-variables.4b15212bc2faf4da239d738a7cf8e545.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Maths" href="maths.html" />
    <link rel="prev" title="API Reference" href="../api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> PyhDToolkit
          </a>
              <div class="version">
                1.0.0rc0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#using-with-docker">Using With Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#minutes-to-pyhdtoolkit">5 Minutes to PyhDToolkit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#cpymadtools">Cpymadtools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#utilities">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart.html#additional-helpers">Additional Helpers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/index.html">Gallery</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_acd_tracking_spectra.html">AC Dipole Driven Tracking Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_aperture.html">Accelerator Aperture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lattice.html">Accelerator Lattice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_beam_enveloppe.html">Beam Enveloppe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_stats_fitting.html">Distributions Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_track_spectra.html">Free Tracking Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lhc_crossing_schemes.html">LHC Crossing Schemes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_ir_errors.html">LHC IR Errors Assignments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html">LHC Rigid Waist Shift</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html#showcasing-the-waist-shift">Showcasing the Waist Shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html#determining-the-waist-shift">Determining the Waist Shift</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_machine_survey.html">Machine Survey</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_phase_space.html">Phase Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_sbs_plotting.html">Segment-by-Segment Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gallery/demo_tune_diagram.html">Tune Diagram</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cpymadtools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#useful-constants">Useful Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="#correctors">Correctors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#betatron-coupling-utilities">Betatron Coupling Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#errors-assignments">Errors Assignments</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lattice-generators">Lattice Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lhc-specific-utilities">LHC-Specific Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matching-routines">Matching Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#orbit-handling">Orbit Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ptc-routines">PTC Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracking-routines">Tracking Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tune-utilities">Tune Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#twiss-routines">TWISS Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#miscellaneous-utilities">Miscellaneous Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="maths.html">Maths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="maths.html#nonconvex-phase-synchronization">Nonconvex Phase Synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="maths.html#stats-fitting">Stats Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="maths.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="models.html#particle-beam-models">Particle Beam Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#htcondor-models">HTCondor Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="models.html#mad-x-models">MAD-X Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="optics.html">Optics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="optics.html#beam-optics">Beam Optics</a></li>
<li class="toctree-l3"><a class="reference internal" href="optics.html#ripken-parameters">Ripken Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="optics.html#twiss-optics">Twiss Optics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#aperture-plotters">Aperture Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#crossing-scheme-plotters">Crossing Scheme Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#beam-enveloppe-plotters">Beam Enveloppe Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#lattice-plotters">Lattice Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#phase-space-plotters">Phase Space Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#tune-diagram-plotters">Tune Diagram Plotters</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#segment-by-segment-coupling">Segment-by-Segment Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#segment-by-segment-phase">Segment-by-Segment Phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="plotting.html#plotting-utility-functions">Plotting Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#command-line-utilities">Command Line Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#context-utilities">Context Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#defaults-setting-utilities">Defaults Setting Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#executors-utilities">Executors Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#htcondor-monitoring">HTCondor Monitoring</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#miscellanous-personnal-utilities">Miscellanous Personnal Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#operations-utilities">Operations Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#printing-utilities">Printing Utilities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#asking-for-help">Asking for Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#bug-reports">Bug Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#enhancement-proposals">Enhancement Proposals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing.html#contributing-code-and-or-documentation">Contributing Code and/or Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#forking-the-repository">Forking the Repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#creating-a-development-environment">Creating a Development Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#creating-a-branch">Creating a Branch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#running-the-test-suite">Running the Test Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#code-standards">Code Standards</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contributing.html#documentation">Documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-21-0">Version 0.21.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.21.0.html">0.21.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-20-1">Version 0.20.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.20.1.html">0.20.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-20-0">Version 0.20.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.20.0.html">0.20.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-19-1">Version 0.19.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.19.1.html">0.19.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-19-0">Version 0.19.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.19.0.html">0.19.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-18-0">Version 0.18.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.18.0.html">0.18.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-17-0">Version 0.17.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.17.0.html">0.17.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-16-1">Version 0.16.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.16.1.html">0.16.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-16-0">Version 0.16.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.16.0.html">0.16.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-15-1">Version 0.15.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.15.1.html">0.15.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-15-0">Version 0.15.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.15.0.html">0.15.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-14-1">Version 0.14.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.14.1.html">0.14.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-14-0">Version 0.14.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.14.0.html">0.14.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-3">Version 0.13.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.3.html">0.13.3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-2">Version 0.13.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.2.html">0.13.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-1">Version 0.13.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.1.html">0.13.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-13-0">Version 0.13.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.13.0.html">0.13.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-12-0">Version 0.12.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.12.0.html">0.12.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-11-0">Version 0.11.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.11.0.html">0.11.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-10-0">Version 0.10.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.10.0.html">0.10.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-2">Version 0.9.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.2.html">0.9.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-1">Version 0.9.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.1.html">0.9.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-9-0">Version 0.9.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.9.0.html">0.9.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-5">Version 0.8.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.5.html">0.8.5</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-4">Version 0.8.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.4.html">0.8.4</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-3">Version 0.8.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.3.html">0.8.3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-2">Version 0.8.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.2.html">0.8.2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-1">Version 0.8.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.1.html">0.8.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-8-0">Version 0.8.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.8.0.html">0.8.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-7-0">Version 0.7.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.7.0.html">0.7.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-6-0">Version 0.6.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.6.0.html">0.6.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-5-0">Version 0.5.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.5.0.html">0.5.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-4-1">Version 0.4.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.4.1.html">0.4.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-4-0">Version 0.4.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.4.0.html">0.4.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-3-0">Version 0.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.3.0.html">0.3.0</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-2-1">Version 0.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.2.1.html">0.2.1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../release.html#version-0-2-0">Version 0.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../releases/v0.2.0.html">0.2.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Reference bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyhDToolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../api.html">API Reference</a> &raquo;</li>
      <li>Cpymadtools</li>
      <li class="wy-breadcrumbs-aside">
              <!-- User defined GitHub URL -->
              <a href="https://github.com/fsoubelet/PyhDToolkit" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cpymadtools">
<span id="pyhdtoolkit-cpymadtools"></span><h1>Cpymadtools<a class="headerlink" href="#cpymadtools" title="Permalink to this headline"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">cpymadtools</span></code> subpackage is a collection of utilities to conveniently handle <a class="reference external" href="https://mad.web.cern.ch/mad/">MAD-X</a> simulations through the <code class="docutils literal notranslate"><span class="pre">cpymad</span></code> library.</p>
<span class="target" id="module-pyhdtoolkit.cpymadtools.constants"></span><section id="useful-constants">
<span id="cpymadtools-constants"></span><h2>Useful Constants<a class="headerlink" href="#useful-constants" title="Permalink to this headline"></a></h2>
<p>Specific constants to be used in <code class="xref py py-obj docutils literal notranslate"><span class="pre">cpymadtools</span></code> functions, to help with consistency.</p>
</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.correctors"></span><section id="correctors">
<span id="cpymadtools-correctors"></span><h2>Correctors<a class="headerlink" href="#correctors" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> correctors-related operations and manipulations
through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, mainly for LHC and HLLHC machines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.correctors.query_arc_correctors_powering">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.correctors.</span></span><span class="sig-name descname"><span class="pre">query_arc_correctors_powering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/correctors.html#query_arc_correctors_powering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.correctors.query_arc_correctors_powering" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Queries for the arc corrector strengths and returns their values as a percentage of
their max powering. This is a port of one of the <strong>corr_value.madx</strong> file’s macros</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object with an
active (HL)LHC sequence.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> with the percentage for each corrector.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arc_knobs</span> <span class="o">=</span> <span class="n">query_arc_correctors_powering</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.correctors.query_triplet_correctors_powering">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.correctors.</span></span><span class="sig-name descname"><span class="pre">query_triplet_correctors_powering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/correctors.html#query_triplet_correctors_powering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.correctors.query_triplet_correctors_powering" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Queries for the triplet corrector strengths and returns their values as a percentage of
their max powering. This is a port of one of the <strong>corr_value.madx</strong> file’s macros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object with an
active (HL)LHC sequence.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> with the percentage for each corrector.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">triplet_knobs</span> <span class="o">=</span> <span class="n">query_triplet_correctors_powering</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.coupling"></span><section id="betatron-coupling-utilities">
<span id="cpymadtools-coupling"></span><h2>Betatron Coupling Utilities<a class="headerlink" href="#betatron-coupling-utilities" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> actions through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, that
retate to betatron coupling in the machine.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.coupling.get_closest_tune_approach">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.coupling.</span></span><span class="sig-name descname"><span class="pre">get_closest_tune_approach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varied_knobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">explicit_targets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-21</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/coupling.html#get_closest_tune_approach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.coupling.get_closest_tune_approach" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<p>Provided with an active <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, tries to match the tunes to their mid-fractional tunes,
a.k.a tries to get them together. The difference between the final reached fractional tunes is the closest
tune approach. This should not have any effect on the user’s simulation, as the varied knobs are
restored to their previous values after performing the CTA. This uses <code class="xref py py-obj docutils literal notranslate"><span class="pre">match_tunes_and_chromaticities</span></code>
under the hood.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This assumes the sequence has previously been matched to the user’s desired working point, as if not
explicitely given, the appropriate targets will be determined from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> internal tables.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This is hard-coded to use the <code class="docutils literal notranslate"><span class="pre">CHROM</span></code> flag when performing matching, since we expect to be in
the presence of betatron coupling. In this case, attempting to match chromaticities at the same time as the
tunes might cause <code class="docutils literal notranslate"><span class="pre">LMDIF</span></code> to fail, as the knobs become dependent. For this reason, only tune matching is
performed here, and chromaticities are voluntarily ignored.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>accelerator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- name of the accelerator, used to determmine knobs if <em>variables</em> is not given.
Automatic determination will only work for <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">HLLHC</span></code>.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- name of the sequence you want to activate for the tune matching.</p></li>
<li><p><strong>varied_knobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables names to <code class="docutils literal notranslate"><span class="pre">VARY</span></code> in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> routine. An input
could be <code class="docutils literal notranslate"><span class="pre">[&quot;kqf&quot;,</span> <span class="pre">&quot;ksd&quot;,</span> <span class="pre">&quot;kqf&quot;,</span> <span class="pre">&quot;kqd&quot;]</span></code> as they are common names used for quadrupole and sextupole
strengths (focusing / defocusing) in most examples.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- <code class="docutils literal notranslate"><span class="pre">LHC</span></code> specific. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="docutils literal notranslate"><span class="pre">(HL)LHC</span></code> knobs for Telescopic
Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> since <code class="xref py py-obj docutils literal notranslate"><span class="pre">v0.9.0</span></code>.</p></li>
<li><p><strong>run3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> Run 3 <code class="xref py py-obj docutils literal notranslate"><span class="pre">*_op</span></code> knobs. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>explicit_targets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">float]</span></code>) -- if given, will be used as matching targets for <code class="xref py py-obj docutils literal notranslate"><span class="pre">(Qx,</span> <span class="pre">Qy)</span></code>.
Otherwise, the target is determined as the middle of the current fractional tunes. Defaults to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- step size to use when varying knobs.</p></li>
<li><p><strong>calls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- max number of varying calls to perform.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- tolerance for successfull matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The closest tune approach, in absolute value.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Say we have set the LHC coupling knobs to 1e-3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dqmin</span> <span class="o">=</span> <span class="n">get_closest_tune_approach</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;lhc&quot;</span><span class="p">,</span>                    <span class="c1"># will find the knobs automatically</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">telescopic_squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># influences the knobs definition</span>
<span class="gp">... </span>    <span class="n">run3</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                <span class="c1"># influences the knobs definition (LHC Run 3)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">0.001</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.coupling.get_cminus_from_coupling_rdts">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.coupling.</span></span><span class="sig-name descname"><span class="pre">get_cminus_from_coupling_rdts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'teapot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtering</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/coupling.html#get_cminus_from_coupling_rdts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.coupling.get_cminus_from_coupling_rdts" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>Computes and returns the <span class="math notranslate nohighlight">\(|C^{-}|\)</span> from the machine’s coupling RDTs. The
closest tune approach is computed thanks to functionality from <a class="reference external" href="https://pylhc.github.io/optics_functions/modules/coupling.html#module-optics_functions.coupling" title="(in optics_functions v0.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optics_functions.coupling</span></code></a>.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>A quick estimate of the <span class="math notranslate nohighlight">\(|C^{-}|\)</span> is available in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> as the <code class="docutils literal notranslate"><span class="pre">dqmin</span></code>
variable in the <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table. However this estimate is not accurate in all situations,
and is the norm of a complex vector which is not approriate for comparisons or for
normalizations, which is the use-case of this functions.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If using the “calaga”, “teapot”, “teapot_franchi” or “franchi” method, then the returned
value will be a real number.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>patterns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the different patterns (such as <code class="docutils literal notranslate"><span class="pre">MQX</span></code> or <code class="docutils literal notranslate"><span class="pre">BPM</span></code>) of elements
to use when computing the coupling RDTs. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">[&quot;&quot;]</span></code> which will select and use
all elements in the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> outputs.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the method to use for the calculation of the <span class="math notranslate nohighlight">\(C^{-}\)</span>. Defaults to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">teapot</span></code>, which is the default of <a class="reference external" href="https://pylhc.github.io/optics_functions/modules/coupling.html#optics_functions.coupling.closest_tune_approach" title="(in optics_functions v0.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">closest_tune_approach</span></code></a>.</p></li>
<li><p><strong>qx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the horizontal tune. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, in which case the value will be taken
from the <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table.</p></li>
<li><p><strong>qy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the vertical tune. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, in which case the value will be taken
from the <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table.</p></li>
<li><p><strong>filtering</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- If non-zero value is given, applies outlier filtering of BPMs based on
the abs. value of the coupling RTDs before computing the <span class="math notranslate nohighlight">\(C^{-}\)</span>. The given value
corresponds to the std. dev. <span class="math notranslate nohighlight">\(\sigma\)</span> outside of which to filter out a BPM.
Defaults to 0, which means no filtering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The calculated <span class="math notranslate nohighlight">\(|C^{-}|\)</span> value.</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">complex_cminus</span> <span class="o">=</span> <span class="n">get_cminus_from_coupling_rdts</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># To simulate the calculation from a measurement, with RDTs at BPMs only</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">complex_cminus</span> <span class="o">=</span> <span class="n">get_cminus_from_coupling_rdts</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;^BPM.*B[12]$&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.coupling.get_coupling_rdts">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.coupling.</span></span><span class="sig-name descname"><span class="pre">get_coupling_rdts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/coupling.html#get_coupling_rdts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.coupling.get_coupling_rdts" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>Computed the coupling Resonance Driving Tensors (RDTs) <span class="math notranslate nohighlight">\(f_{1001}\)</span> and <span class="math notranslate nohighlight">\(f_{1010}\)</span>
at all elements in the currently active sequence from a <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument will be transmitted to the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.
Note that <code class="docutils literal notranslate"><span class="pre">CHROM</span></code> is already provided as it is needed for the RDTs’ calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code> with columns of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table, and two complex columns for the
<code class="docutils literal notranslate"><span class="pre">F1001</span></code> and <code class="docutils literal notranslate"><span class="pre">f1010</span></code> RDTs.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twiss_rdts</span> <span class="o">=</span> <span class="n">get_coupling_rdts</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.coupling.match_no_coupling_through_ripkens">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.coupling.</span></span><span class="sig-name descname"><span class="pre">match_no_coupling_through_ripkens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vary_knobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/coupling.html#match_no_coupling_through_ripkens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.coupling.match_no_coupling_through_ripkens" title="Permalink to this definition"></a></dt>
<dd><p>..versionadded:: 0.16.0</p>
<p>Matching routine to get cross-term Ripken parameters <span class="math notranslate nohighlight">\(\beta_{12}\)</span> and <span class="math notranslate nohighlight">\(\beta_{21}\)</span>
to be 0 at a given location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- name of the sequence to activate for the matching.</p></li>
<li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the element at which one wants the cross-term Ripkens to be 0.</p></li>
<li><p><strong>vary_knobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables names to <code class="docutils literal notranslate"><span class="pre">VARY</span></code> in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> routine.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">match_no_coupling_through_ripkens</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s2">&quot;IP5&quot;</span><span class="p">,</span> <span class="n">vary_knobs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kqsx.3l5&quot;</span><span class="p">,</span> <span class="s2">&quot;kqsx.3r5&quot;</span><span class="p">]</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.errors"></span><section id="errors-assignments">
<span id="cpymadtools-errors"></span><h2>Errors Assignments<a class="headerlink" href="#errors-assignments" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> errors setups and manipulations through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a>
object, mainly for LHC and HLLHC machines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.errors.misalign_lhc_ir_quadrupoles">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.errors.</span></span><span class="sig-name descname"><span class="pre">misalign_lhc_ir_quadrupoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ips</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadrupoles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('r',</span> <span class="pre">'l')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ir_quads_errors'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/errors.html#misalign_lhc_ir_quadrupoles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.errors.misalign_lhc_ir_quadrupoles" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Apply misalignment errors to IR quadrupoles on a given side of given IPs. In case of a sliced
lattice, this will misalign all slices of each magnet together. According to the
<a class="reference external" href="https://edms5.cern.ch/cedar/plsql/codes.systems">Equipment Codes Main System</a>,  those are Q1
to Q10 included, quads beyond are <code class="docutils literal notranslate"><span class="pre">MQ</span></code> or <code class="docutils literal notranslate"><span class="pre">MQT</span></code> which are considered arc elements.</p>
<p>One can find a full example use of the function for tracking in the
<a class="reference internal" href="../gallery/demo_ir_errors.html#demo-ir-errors"><span class="std std-ref">LHC IR Errors</span></a> example gallery.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This implementation is only valid for LHC IP IRs, which are 1, 2, 5 and 8. Other IRs have
different layouts incompatible with this function.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>One should avoid issuing different errors with several uses of this command as it is unclear to me
how <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> chooses to handle this internally. Instead, it is advised to give all errors in the same
command, which is guaranteed to work. See the last provided example below.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>ips</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[int]</span></code>) -- the interaction point(s) around which to apply errors.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- beam number to apply the errors to. Unlike triplet quadrupoles which are single
aperture, Q4 to Q10 are not and will need this information.</p></li>
<li><p><strong>quadrupoles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[int]</span></code>) -- the number of the quadrupoles to apply errors to.</p></li>
<li><p><strong>sides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- sides of the IP to apply error on the triplets, either L or R or both.
Case-insensitive. Defaults to both.</p></li>
<li><p><strong>table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table that will save the assigned errors. Defaults to
‘ir_quads_errors’.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument is given to the <code class="docutils literal notranslate"><span class="pre">EALIGN</span></code> command, including the error to apply
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">DX</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DY</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DPSI</span></code> etc) as a string, like it would be given directly into <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>For systematic <code class="docutils literal notranslate"><span class="pre">DX</span></code> misalignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">misalign_lhc_ir_quadrupoles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">quadrupoles</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="s2">&quot;RL&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="s2">&quot;1E-5&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>For a tilt distribution centered on 1mrad:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">misalign_lhc_ir_quadrupoles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">quadrupoles</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="s2">&quot;RL&quot;</span><span class="p">,</span> <span class="n">dpsi</span><span class="o">=</span><span class="s2">&quot;1E-3 + 8E-4 * TGAUSS(2.5)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>For several error types on the elements, here <code class="docutils literal notranslate"><span class="pre">DY</span></code> and <code class="docutils literal notranslate"><span class="pre">DPSI</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">misalign_lhc_ir_quadrupoles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">ips</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">quadrupoles</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">sides</span><span class="o">=</span><span class="s2">&quot;RL&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dy</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>  <span class="c1"># ok too as cpymad converts this to a string first</span>
<span class="gp">... </span>    <span class="n">dpsi</span><span class="o">=</span><span class="s2">&quot;1E-3 + 8E-4 * TGAUSS(2.5)&quot;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.errors.misalign_lhc_triplets">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.errors.</span></span><span class="sig-name descname"><span class="pre">misalign_lhc_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('r',</span> <span class="pre">'l')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'triplet_errors'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/errors.html#misalign_lhc_triplets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.errors.misalign_lhc_triplets" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Apply misalignment errors to IR triplet quadrupoles on a given side of a given IP. In case of a
sliced lattice, this will misalign all slices of each magnet together. This is a convenience wrapper
around the <a class="reference internal" href="#pyhdtoolkit.cpymadtools.errors.misalign_lhc_ir_quadrupoles" title="pyhdtoolkit.cpymadtools.errors.misalign_lhc_ir_quadrupoles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">misalign_lhc_ir_quadrupoles</span></code></a> function, see that function’s docstring for more
information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>ip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the interaction point around which to apply errors.</p></li>
<li><p><strong>sides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- sides of the IP to apply error on the triplets, either L or R or both.
Case-insensitive. Defaults to both.</p></li>
<li><p><strong>table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table that will save the assigned errors. Defaults to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">triplet_errors</span></code>.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument is given to the <code class="docutils literal notranslate"><span class="pre">EALIGN</span></code> command, including the error to apply
(<code class="xref py py-obj docutils literal notranslate"><span class="pre">DX</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DY</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">DPSI</span></code> etc) as a string, like it would be given directly into <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>A random, gaussian truncated <code class="docutils literal notranslate"><span class="pre">DX</span></code> misalignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">misalign_lhc_triplets</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="s2">&quot;RL&quot;</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="s2">&quot;1E-5 * TGAUSS(2.5)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>A random, gaussian truncated <code class="docutils literal notranslate"><span class="pre">DPSI</span></code> misalignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">misalign_lhc_triplets</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="s2">&quot;RL&quot;</span><span class="p">,</span> <span class="n">dpsi</span><span class="o">=</span><span class="s2">&quot;0.001 * TGAUSS(2.5)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.errors.switch_magnetic_errors">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.errors.</span></span><span class="sig-name descname"><span class="pre">switch_magnetic_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/errors.html#switch_magnetic_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.errors.switch_magnetic_errors" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.0.</span></p>
</div>
<p>Applies magnetic field orders. This will only work for LHC and HLLHC machines.
Initial implementation credits go to <a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>**kwargs</strong> -- The setting works through keyword arguments, and several specific
kwargs are expected. <code class="xref py py-obj docutils literal notranslate"><span class="pre">default</span></code> sets global default to this value (defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>).
<code class="xref py py-obj docutils literal notranslate"><span class="pre">AB#</span></code> sets the default for all of that order, the order being the <code class="xref py py-obj docutils literal notranslate"><span class="pre">#</span></code> number. <code class="xref py py-obj docutils literal notranslate"><span class="pre">A#</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">B#</span></code> sets the default for systematic and random of this id. <code class="xref py py-obj docutils literal notranslate"><span class="pre">A#s</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">B#r</span></code>, etc. sets the
specific value for this given order. In all kwargs, the order # should be in the range
[1…15], where 1 == dipolar field.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>Set random values for (alsmost) all of these orders:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">random_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="s2">&quot;AB&quot;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">random_kwargs</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ab</span><span class="si">}{</span><span class="n">order</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">switch_magnetic_errors</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="o">**</span><span class="n">random_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Set a given value for <code class="docutils literal notranslate"><span class="pre">B6</span></code> order magnetic errors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">switch_magnetic_errors</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="s2">&quot;B6&quot;</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.generators"></span><section id="lattice-generators">
<span id="cpymadtools-generators"></span><h2>Lattice Generators<a class="headerlink" href="#lattice-generators" title="Permalink to this headline"></a></h2>
<p>Module with a collection of functions generating different lattices for <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> input.
These lattices are quite simple and are meant to be used in the package’s documentation and
<a class="reference internal" href="../gallery/index.html#gallery"><span class="std std-ref">example gallery</span></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.generators.LatticeGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.generators.</span></span><span class="sig-name descname"><span class="pre">LatticeGenerator</span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/generators.html#LatticeGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.generators.LatticeGenerator" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.1.0.</span></p>
</div>
<p>A simple class to handle encompass generating functions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_base_cas_lattice">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_base_cas_lattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/generators.html#LatticeGenerator.generate_base_cas_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_base_cas_lattice" title="Permalink to this definition"></a></dt>
<dd><p>Generates a simple and robust dummy lattice, initially designed for my
CERN Accelerator School optics project.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string to directly <code class="docutils literal notranslate"><span class="pre">.input()</span></code> into your <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_oneoct_cas_lattice">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_oneoct_cas_lattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/generators.html#LatticeGenerator.generate_oneoct_cas_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_oneoct_cas_lattice" title="Permalink to this definition"></a></dt>
<dd><p>Generates the dummy lattice with a sextupole and an octupole added
to excite third and fourth order resonances.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string to directly <code class="docutils literal notranslate"><span class="pre">.input()</span></code> into your <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_onesext_cas_lattice">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_onesext_cas_lattice</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/generators.html#LatticeGenerator.generate_onesext_cas_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.generators.LatticeGenerator.generate_onesext_cas_lattice" title="Permalink to this definition"></a></dt>
<dd><p>Generates the dummy lattice with a sextupole added to excite third order
resonances.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A string to directly <code class="docutils literal notranslate"><span class="pre">.input()</span></code> into your <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.lhc"></span><section id="lhc-specific-utilities">
<span id="cpymadtools-lhc"></span><h2>LHC-Specific Utilities<a class="headerlink" href="#lhc-specific-utilities" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> actions through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object,
that are specific to LHC and HLLHC machines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">apply_lhc_colinearity_knob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">colinearity_knob_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#apply_lhc_colinearity_knob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Applies the LHC colinearity knob.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t know what this is, you really should not be using this function.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The convention, which is also the one I implemented in <code class="docutils literal notranslate"><span class="pre">LSA</span></code> for the <code class="docutils literal notranslate"><span class="pre">LHC</span></code>, is that a
positive value of the colinearity knob results in a powering increase of the <code class="docutils literal notranslate"><span class="pre">MQSX</span></code> <em>right</em>
of the IP, and a powering decrease of the <code class="docutils literal notranslate"><span class="pre">MQSX</span></code> <em>left</em> of the IP.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>colinearity_knob_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- Units of the colinearity knob to apply. Defaults to 0 so users
don’t mess up local IR coupling by mistake. This should be a positive integer, normally between 1
and 10.</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- The Interaction Region to apply the knob to, should be one of [1, 2, 5, 8].
Classically 1 or 5.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_lhc_colinearity_knob</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">colinearity_knob_value</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob_delta">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">apply_lhc_colinearity_knob_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">colinearity_knob_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#apply_lhc_colinearity_knob_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob_delta" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.21.0.</span></p>
</div>
<p>This is essentially the same as <a class="reference internal" href="#pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob" title="pyhdtoolkit.cpymadtools.lhc.apply_lhc_colinearity_knob"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_lhc_colinearity_knob</span></code></a>, but instead of a applying fixed powering
value, it applies to delta to the existing value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t know what this is, you really should not be using this function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>colinearity_knob_delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- Units of the colinearity knob to vary the existing powerings with.
Defaults to 0.</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- The Interaction Region to apply the knob to, should be one of [1, 2, 5, 8].
Classically 1 or 5.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_lhc_colinearity_knob_delta</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">colinearity_knob_delta</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.apply_lhc_coupling_knob">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">apply_lhc_coupling_knob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_knob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#apply_lhc_coupling_knob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.apply_lhc_coupling_knob" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Applies the LHC coupling knob to reach the desired <span class="math notranslate nohighlight">\(|C^{-}|\)</span> value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>coupling_knob</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- Desired value for the Cminus, typically a few units of <code class="docutils literal notranslate"><span class="pre">1E-3</span></code>.
Defaults to 0 so users don’t mess up coupling by mistake.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- beam to apply the knob to. Defaults to beam 1.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the knobs for Telescopic Squeeze configuration.
Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> since <code class="xref py py-obj docutils literal notranslate"><span class="pre">v0.9.0</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apply_lhc_coupling_knob</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">coupling_knob</span><span class="o">=</span><span class="mf">5e-4</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.apply_lhc_rigidity_waist_shift_knob">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">apply_lhc_rigidity_waist_shift_knob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rigidty_waist_shift_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#apply_lhc_rigidity_waist_shift_knob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.apply_lhc_rigidity_waist_shift_knob" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Applies the LHC rigidity waist shift knob, moving the waist left or right of IP.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you don’t know what this is, you really should not be using this function. The waist shift
is achieved by moving all four betatron waists simltaneously: unbalancing the triplet powering
knobs of the left and right-hand sides of the IP,</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Applying the shift will modify your tunes and is likely to flip them, making a subsequent matching
impossible if your lattice has coupling. To avoid this, one should match to tunes split further apart
before applying the waist shift knob, and then match to the desired working point. For instance for
the LHC, matching to (62.27, 60.36) before applying and afterwards rematching to (62.31, 60.32) usually
works well.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>rigidty_waist_shift_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- Units of the rigidity waist shift knob (positive values only).</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- The Interaction Region to apply the knob to, should be one of [1, 2, 5, 8].
Classically 1 or 5.</p></li>
<li><p><strong>side</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- Which side of the IP to move the waist to, determines a sign in the calculation.
Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">left</span></code>, which means <span class="math notranslate nohighlight">\(s_{\mathrm{waist}} \lt s_{\mathrm{ip}}\)</span> (and
setting it to <code class="xref py py-obj docutils literal notranslate"><span class="pre">right</span></code> would move the waist such that
<span class="math notranslate nohighlight">\(s_{\mathrm{waist}} \gt s_{\mathrm{ip}}\)</span>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes_and_chromaticities</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="s2">&quot;lhc&quot;</span><span class="p">,</span> <span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="mf">62.27</span><span class="p">,</span> <span class="mf">60.36</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">apply_lhc_rigidity_waist_shift_knob</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">rigidty_waist_shift_value</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes_and_chromaticities</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="s2">&quot;lhc&quot;</span><span class="p">,</span> <span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="mf">62.31</span><span class="p">,</span> <span class="mf">60.32</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.carry_colinearity_knob_over">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">carry_colinearity_knob_over</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#carry_colinearity_knob_over"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.carry_colinearity_knob_over" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>Removes the powering setting on one side of the colinearty knob and applies it to the
other side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- The Interaction Region around which to apply the change, should be
one of [1, 2, 5, 8].</p></li>
<li><p><strong>to_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the magnet right of IP is powered of and its powering
is transferred to the magnet left of IP. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, then the opposite happens.
Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">carry_colinearity_knob_over</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">to_left</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.correct_lhc_global_coupling">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">correct_lhc_global_coupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-21</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#correct_lhc_global_coupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.correct_lhc_global_coupling" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>A littly tricky matching routine to perform a decent global coupling correction using
the <code class="docutils literal notranslate"><span class="pre">LHC</span></code> coupling knobs.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This routine makes use of some matching tricks and uses the <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table’s
<code class="docutils literal notranslate"><span class="pre">dqmin</span></code> variable for the matching. It should be considered a helpful little
trick, but it is not a perfect solution.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- which beam you want to perform the matching for, should be <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">2</span></code>. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the coupling knobs
for Telescopic Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p></li>
<li><p><strong>calls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- max number of varying calls to perform when matching. Defaults to 100.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- tolerance for successfull matching. Defaults to <span class="math notranslate nohighlight">\(10^{-21}\)</span>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">correct_lhc_global_coupling</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="n">telescopic_squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.deactivate_lhc_arc_sextupoles">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">deactivate_lhc_arc_sextupoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#deactivate_lhc_arc_sextupoles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.deactivate_lhc_arc_sextupoles" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Deactivates all arc sextupoles in the (HL)LHC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- beam to use.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">deactivate_lhc_arc_sextupoles</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.do_kmodulation">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">do_kmodulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#do_kmodulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.do_kmodulation" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.20.0.</span></p>
</div>
<p>Simulates a K-Modulation measurement by varying the powering of Q1 left or
right of the IP, and returning the tune variations resulting from this
modulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At the end of the simulation, the powering of the quadrupole is reset
to the value it had at the time of function call.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>From these, one can then calculate the <span class="math notranslate nohighlight">\(\beta\)</span>-functions at the Q1
and then at the IP, plus the possible waist shift, according to
<span id="id1">Carlier and Tomás [<a class="reference internal" href="../bibliography.html#id9" title="F. Carlier and R. Tomás. Accuracy and feasibility of the β * measurement for LHC and High Luminosity LHC using k modulation. Phys. Rev. ST Accel. Beams, 2017. doi:10.1103/PhysRevAccelBeams.20.011005.">CT17</a>]</span>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the IR in which to perform the modulation. Defaults to 1.</p></li>
<li><p><strong>side</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- which side of the IP to use the Q1 to perform the modulation.
Should be either <code class="docutils literal notranslate"><span class="pre">right</span></code> or <code class="docutils literal notranslate"><span class="pre">left</span></code>, case-insensitive. Defaults to
<code class="docutils literal notranslate"><span class="pre">right</span></code>.</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of steps to perform in the modulations, aka the number
of “measurements”. Defaults to 100.</p></li>
<li><p><strong>stepsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the increment in powering for Q1, in direct values of the
powering variable used in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>. Defaults to 3e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code> containing the tune values at each powering step.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tune_results</span> <span class="o">=</span> <span class="n">do_kmodulation</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">ir</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">3e-8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.get_lhc_bpms_list">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">get_lhc_bpms_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#get_lhc_bpms_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.get_lhc_bpms_list" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<p>Returns the list of monitoring BPMs for the current LHC sequence in use.
The BPMs are queried through a regex in the result of a <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As this function calls the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command and requires that <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> can
succeed on your sequence.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instantiated cpymad.madx.Madx object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> of BPM names.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">observation_bpms</span> <span class="o">=</span> <span class="n">get_lhc_bpms_list</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.get_lhc_bpms_twiss_and_rdts">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">get_lhc_bpms_twiss_and_rdts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#get_lhc_bpms_twiss_and_rdts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.get_lhc_bpms_twiss_and_rdts" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.19.0.</span></p>
</div>
<p>Runs a <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> on the currently active sequence for all <code class="docutils literal notranslate"><span class="pre">LHC</span></code> BPMs. The coupling RDTs
are also computed through a CMatrix approach via  <a class="reference external" href="https://pylhc.github.io/optics_functions/modules/coupling.html#optics_functions.coupling.coupling_via_cmatrix" title="(in optics_functions v0.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optics_functions.coupling.coupling_via_cmatrix</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table with basic default columns, as well as one
new column for each of the coupling RDTs. The coupling RDTs are returned as complex numbers.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twiss_with_rdts</span> <span class="o">=</span> <span class="n">get_lhc_bpms_twiss_and_rdts</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.get_lhc_tune_and_chroma_knobs">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">get_lhc_tune_and_chroma_knobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#get_lhc_tune_and_chroma_knobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.get_lhc_tune_and_chroma_knobs" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.16.0.</span></p>
</div>
<p>Gets names of knobs needed to match tunes and chromaticities as a tuple of strings,
for the LHC or HLLHC machines. Initial implementation credits go to
<a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accelerator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- Accelerator either ‘LHC’ (dQ[xy], dQp[xy] knobs) or ‘HLLHC’
(kqt[fd], ks[fd] knobs).</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- Beam to use, for the knob names. Defaults to 1.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the knobs for Telescopic
Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> to reflect run III scenarios.</p></li>
<li><p><strong>run3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, returns the Run 3 <code class="xref py py-obj docutils literal notranslate"><span class="pre">*_op</span></code> knobs. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> of strings with knobs for <code class="docutils literal notranslate"><span class="pre">(qx,</span> <span class="pre">qy,</span> <span class="pre">dqx,</span> <span class="pre">dqy)</span></code>.</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_lhc_tune_and_chroma_knobs</span><span class="p">(</span><span class="s2">&quot;LHC&quot;</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">telescopic_squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">(&#39;dQx.b1&#39;, &#39;dQy.b1&#39;, &#39;dQpx.b1&#39;, &#39;dQpy.b1&#39;)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_lhc_tune_and_chroma_knobs</span><span class="p">(</span><span class="s2">&quot;LHC&quot;</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">run3</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(&#39;dQx.b2_op&#39;, &#39;dQx.b2_op&#39;, &#39;dQpx.b2_op&#39;, &#39;dQpx.b2_op&#39;)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_lhc_tune_and_chroma_knobs</span><span class="p">(</span><span class="s2">&quot;HLLHC&quot;</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(&#39;kqtf.b2_sq&#39;, &#39;kqtd.b2_sq&#39;, &#39;ksf.b2_sq&#39;, &#39;ksd.b2_sq&#39;)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.get_magnets_powering">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">get_magnets_powering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['^mb\\.',</span> <span class="pre">'^mq\\.',</span> <span class="pre">'^ms\\.']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#get_magnets_powering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.get_magnets_powering" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<p>Gets the twiss table with additional defined columns for the given <em>patterns</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here are below certain useful patterns for the <code class="docutils literal notranslate"><span class="pre">LHC</span></code> and their meaning:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">^mb\.</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> main bends.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mq\.</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> main quadrupoles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^ms\.</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> main sextupoles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mb[rswx]</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> separation dipoles.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mq[mwxy]</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> insertion quads.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mqt.1[23]</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> short tuning quads (12 &amp; 13).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mqtl</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> long  tuning quads.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mcbx</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> crossing scheme magnets.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">^mcb[cy]</span></code> <span class="math notranslate nohighlight">\(\\rightarrow\)</span> crossing scheme magnets.</p></li>
</ul>
<p>To make no selection, one can give <code class="docutils literal notranslate"><span class="pre">patterns=[&quot;&quot;]</span></code> and this will give back
the results for <em>all</em> elements. One can also give a specific magnet’s exact
name to include it in the results.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> flag will be fully cleared after running this function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>patterns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- a list of regex patterns to define which elements
should be selected and included in the returned table. Defaults to selecting
the main bends, quads and sextupoles. See the note admonition above for
useful patterns to select specific <code class="docutils literal notranslate"><span class="pre">LHC</span></code> magnet families.</p></li>
<li><p><strong>brho</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[str,</span> <span class="pre">float]</span></code>) -- optional, an explicit definition for the magnetic
rigidity in <span class="math notranslate nohighlight">\(Tm^{-1}\)</span>. If not given, it will be assumed that
a <code class="docutils literal notranslate"><span class="pre">brho</span></code> quantity is defined in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> globals.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument will be passed to <a class="reference internal" href="#pyhdtoolkit.cpymadtools.twiss.get_pattern_twiss" title="pyhdtoolkit.cpymadtools.twiss.get_pattern_twiss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pattern_twiss</span></code></a> and
later on to the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command executed in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code> of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table, with the relevant newly defined columns
and including the elements matching the regex <em>patterns</em> that were provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_kicker">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">install_ac_dipole_as_kicker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaqx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaqy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_turn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ramp_turns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_turns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6600</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#install_ac_dipole_as_kicker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_kicker" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Installs an AC dipole as a kicker element in (HL)LHC beam 1 or 2, for tracking. This function
assumes that you have already defined lhcb1/lhcb2 sequence, made a beam for it (<code class="docutils literal notranslate"><span class="pre">BEAM</span></code>
command or <code class="xref py py-obj docutils literal notranslate"><span class="pre">make_lhc_beams</span></code> function), matched to your desired working point and made
a <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> call.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In a real machine, the AC Dipole does impact the orbit as well as the betatron
functions when turned on (<span id="id2">Miyamoto <em>et al.</em> [<a class="reference internal" href="../bibliography.html#id3" title="R. Miyamoto, S. E. Kopp, A. Jansson, and M. J. Syphers. Parametrization of the driven betatron oscillation. Phys. Rev. ST Accel. Beams, 11:084002, Aug 2008. URL: https://link.aps.org/doi/10.1103/PhysRevSTAB.11.084002, doi:10.1103/PhysRevSTAB.11.084002.">MKJS08</a>]</span>, part III). In <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>
however, it cannot be modeled to do both at the same time. This routine introduces
an AC Dipole as a kicker element so that its effect can be seen on particle trajectory
in tracking. It <strong>does not</strong> affect <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> functions.</p>
</div>
<p>One can find a full example use of the function for tracking in the
<a class="reference internal" href="../gallery/demo_acd_tracking_spectra.html#demo-ac-dipole-tracking"><span class="std std-ref">AC Dipole Tracking</span></a> example gallery.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>deltaqx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the deltaQx (horizontal tune excitation) used by the AC dipole.</p></li>
<li><p><strong>deltaqy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the deltaQy (vertical tune excitation) used by the AC dipole.</p></li>
<li><p><strong>sigma_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the horizontal amplitude to drive the beam to, in bunch sigma.</p></li>
<li><p><strong>sigma_y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the vertical amplitude to drive the beam to, in bunch sigma.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the LHC beam to install the AC Dipole into, either 1 or 2. Defaults to 1.</p></li>
<li><p><strong>start_turn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the turn at which to start ramping up the AC dipole. Defaults to 100.</p></li>
<li><p><strong>ramp_turns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of turns to use for the ramp-up and the ramp-down of the AC dipole.
This number is important in order to preserve the adiabaticity of the cycle. Defaults to 2000
as in the LHC.</p></li>
<li><p><strong>top_turns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of turns to drive the beam for. Defaults to 6600 as in the LHC.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhc</span><span class="o">.</span><span class="n">install_ac_dipole_as_kicker</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">deltaqx</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># driven horizontal tune to Qxd = 62.31 - 0.01 = 62.30</span>
<span class="gp">... </span>    <span class="n">deltaqy</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span>  <span class="c1"># driven vertical tune to Qyd = 60.32 + 0.012 = 60.332</span>
<span class="gp">... </span>    <span class="n">sigma_x</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># bunch amplitude kick in the horizontal plane</span>
<span class="gp">... </span>    <span class="n">sigma_y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># bunch amplitude kick in the vertical plane</span>
<span class="gp">... </span>    <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># beam for which to install and kick</span>
<span class="gp">... </span>    <span class="n">start_turn</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>  <span class="c1"># when to turn on the AC Dipole</span>
<span class="gp">... </span>    <span class="n">ramp_turns</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>  <span class="c1"># how many turns to ramp up/down the AC Dipole</span>
<span class="gp">... </span>    <span class="n">top_turns</span><span class="o">=</span><span class="mi">6600</span><span class="p">,</span>  <span class="c1"># how many turns to keep the AC Dipole at full kick</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_matrix">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">install_ac_dipole_as_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaqx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaqy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#install_ac_dipole_as_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_matrix" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Installs an AC dipole as a matrix element in (HL)LHC beam 1 or 2, to see its effect on TWISS functions
This function assumes that you have already defined lhcb1/lhcb2 sequence, made a beam for it (<code class="docutils literal notranslate"><span class="pre">BEAM</span></code>
command or <code class="xref py py-obj docutils literal notranslate"><span class="pre">make_lhc_beams</span></code> function), matched to your desired working point and made a <code class="docutils literal notranslate"><span class="pre">TWISS</span></code>
call.</p>
<p>This function’s use is very similar to that of <a class="reference internal" href="#pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_kicker" title="pyhdtoolkit.cpymadtools.lhc.install_ac_dipole_as_kicker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">install_ac_dipole_as_kicker</span></code></a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In a real machine, the AC Dipole does impact the orbit as well as the betatron
functions when turned on (<span id="id3">Miyamoto <em>et al.</em> [<a class="reference internal" href="../bibliography.html#id3" title="R. Miyamoto, S. E. Kopp, A. Jansson, and M. J. Syphers. Parametrization of the driven betatron oscillation. Phys. Rev. ST Accel. Beams, 11:084002, Aug 2008. URL: https://link.aps.org/doi/10.1103/PhysRevSTAB.11.084002, doi:10.1103/PhysRevSTAB.11.084002.">MKJS08</a>]</span>, part III). In <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>
however, it cannot be modeled to do both at the same time. This routine introduces
an AC Dipole as a matrix element so that its effect can be seen on <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> functions.
It <strong>does not</strong> affect tracking.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>deltaqx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the deltaQx (horizontal tune excitation) used by the AC dipole.</p></li>
<li><p><strong>deltaqy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the deltaQy (vertical tune excitation) used by the AC dipole.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the LHC beam to install the AC Dipole into, either 1 or 2. Defaults to 1.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">install_ac_dipole_as_matrix</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">deltaqx</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">deltaqy</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.make_lhc_beams">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">make_lhc_beams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emittance_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.75e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emittance_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3.75e-06</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#make_lhc_beams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.make_lhc_beams" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Defines beams with default configuratons for <code class="docutils literal notranslate"><span class="pre">LHCB1</span></code> and <code class="docutils literal notranslate"><span class="pre">LHCB2</span></code> sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- beam energy, in [GeV]. Defaults to 6500.</p></li>
<li><p><strong>emittance_x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- horizontal emittance in [m]. Will be used to calculate
geometric emittance which is then fed to the <code class="docutils literal notranslate"><span class="pre">BEAM</span></code> command.</p></li>
<li><p><strong>emittance_x</strong> -- vertical emittance in [m]. Will be used to calculate
geometric emittance which is then fed to the <code class="docutils literal notranslate"><span class="pre">BEAM</span></code> command.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">BEAM</span></code> command.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_lhc_beams</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mi">6800</span><span class="p">,</span> <span class="n">emittance_x</span><span class="o">=</span><span class="mf">2.5e-6</span><span class="p">,</span> <span class="n">emittance_y</span><span class="o">=</span><span class="mf">3e-6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.make_lhc_thin">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">make_lhc_thin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">slicefactor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#make_lhc_thin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.make_lhc_thin" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Executes the <code class="docutils literal notranslate"><span class="pre">MAKETHIN</span></code> command for the LHC sequence as previously done in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> macros.
This will use the <code class="docutils literal notranslate"><span class="pre">teapot</span></code> style and will enforce <code class="docutils literal notranslate"><span class="pre">makedipedge</span></code>.</p>
<p>One can find an exemple use of this function in the <a class="reference internal" href="../gallery/demo_acd_tracking_spectra.html#demo-ac-dipole-tracking"><span class="std std-ref">AC Dipole Tracking</span></a>
and <a class="reference internal" href="../gallery/demo_track_spectra.html#demo-free-tracking"><span class="std std-ref">Free Tracking</span></a> example galleries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instantiated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the sequence to use for the <code class="docutils literal notranslate"><span class="pre">MAKETHIN</span></code> command.</p></li>
<li><p><strong>slicefactor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the slice factor to apply in <code class="docutils literal notranslate"><span class="pre">MAKETHIN</span></code>, which is a factor
applied to default values for different elements, as did the old macro. Defaults
to 1.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument will be transmitted to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">MAKETHN</span></code>
command, namely <code class="docutils literal notranslate"><span class="pre">style</span></code> (will default to <code class="docutils literal notranslate"><span class="pre">teapot</span></code>) and the <code class="docutils literal notranslate"><span class="pre">makedipedge</span></code>
flag (will default to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>).</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_lhc_thin</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="n">slicefactor</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.make_sixtrack_output">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">make_sixtrack_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#make_sixtrack_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.make_sixtrack_output" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Prepare output for a <code class="docutils literal notranslate"><span class="pre">SixTrack</span></code> run. Initial implementation credits go to
<a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- beam energy, in [GeV].</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_sixtrack_output</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="mi">6800</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.power_landau_octupoles">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">power_landau_octupoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">defective_arc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#power_landau_octupoles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.power_landau_octupoles" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Powers the Landau octupoles in the (HL)LHC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- beam to use.</p></li>
<li><p><strong>mo_current</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- <code class="xref py py-obj docutils literal notranslate"><span class="pre">MO</span></code> powering, in [A].</p></li>
<li><p><strong>defective_arc</strong> -- If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the <code class="docutils literal notranslate"><span class="pre">KOD</span></code> in Arc 56 are powered for less <code class="docutils literal notranslate"><span class="pre">Imax</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">power_landau_octupoles</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mo_current</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">defect_arc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.re_cycle_sequence">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">re_cycle_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lhcb1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'IP3'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#re_cycle_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.re_cycle_sequence" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Re-cycles the provided <em>sequence</em> from a different starting point, given as <em>start</em>.</p>
<p>One can find an exemple use of this function in the <a class="reference internal" href="../gallery/demo_acd_tracking_spectra.html#demo-ac-dipole-tracking"><span class="std std-ref">AC Dipole Tracking</span></a>
and <a class="reference internal" href="../gallery/demo_track_spectra.html#demo-free-tracking"><span class="std std-ref">Free Tracking</span></a> example galleries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instantiated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the sequence to re-cycle.</p></li>
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- element to start the new cycle from.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lhc</span><span class="o">.</span><span class="n">re_cycle_sequence</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;MSIA.EXIT.B1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.reset_lhc_bump_flags">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">reset_lhc_bump_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#reset_lhc_bump_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.reset_lhc_bump_flags" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Resets all LHC IP bump flags to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reset_lhc_bump_flags</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.lhc.vary_independent_ir_quadrupoles">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.lhc.</span></span><span class="sig-name descname"><span class="pre">vary_independent_ir_quadrupoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">quad_numbers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('r',</span> <span class="pre">'l')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/lhc.html#vary_independent_ir_quadrupoles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.lhc.vary_independent_ir_quadrupoles" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.15.0.</span></p>
</div>
<p>Sends the <code class="docutils literal notranslate"><span class="pre">VARY</span></code> commands for the desired quadrupoles in the IR surrounding the provided <em>ip</em>.
The independent quadrupoles for which this is implemented are Q4 to Q13 included. This is useful
to setup some specific matching involving these elements.</p>
<dl class="simple">
<dt>..important::</dt><dd><p>It is necessary to have defined a <code class="docutils literal notranslate"><span class="pre">brho</span></code> variable when creating your beams.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>quad_numbers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[int]</span></code>) -- quadrupoles to be varied, by number (aka position from IP).</p></li>
<li><p><strong>ip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the IP around which to apply the instructions.</p></li>
<li><p><strong>sides</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the sides of IP to act on. Should be <code class="xref py py-obj docutils literal notranslate"><span class="pre">R</span></code> for right and <code class="xref py py-obj docutils literal notranslate"><span class="pre">L</span></code> for left,
accepts these letters case-insensitively. Defaults to both sides of the IP.</p></li>
<li><p><strong>beam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the beam for which to apply the instructions. Defaults to 1.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">vary_independent_ir_quadrupoles</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">quad_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">ip</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sides</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.matching"></span><section id="matching-routines">
<span id="cpymadtools-matching"></span><h2>Matching Routines<a class="headerlink" href="#matching-routines" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> matchings through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.matching.match_chromaticities">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.matching.</span></span><span class="sig-name descname"><span class="pre">match_chromaticities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq1_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq2_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varied_knobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-21</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/matching.html#match_chromaticities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.matching.match_chromaticities" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<p>Provided with an active <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, will run relevant commands to match chromaticities
to the desired target values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a wrapper around the <a class="reference internal" href="#pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities" title="pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_tunes_and_chromaticities</span></code></a> function. Refer to its documentation
for usage details.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The matching is always performed with the <code class="docutils literal notranslate"><span class="pre">CHROM</span></code> option on.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>accelerator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- name of the accelerator, used to determmine knobs if <em>variables</em> is not given.
Automatic determination will only work for <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">HLLHC</span></code>.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- name of the sequence you want to perform the matching for.</p></li>
<li><p><strong>q1_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- horizontal tune to match to.</p></li>
<li><p><strong>q2_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- vertical tune to match to.</p></li>
<li><p><strong>varied_knobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables names to <code class="docutils literal notranslate"><span class="pre">VARY</span></code> in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> routine.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- <code class="docutils literal notranslate"><span class="pre">LHC</span></code> specific. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="docutils literal notranslate"><span class="pre">(HL)LHC</span></code> knobs for Telescopic
Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> since <code class="xref py py-obj docutils literal notranslate"><span class="pre">v0.9.0</span></code>.</p></li>
<li><p><strong>run3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> Run 3 <code class="xref py py-obj docutils literal notranslate"><span class="pre">*_op</span></code> knobs. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- step size to use when varying knobs. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">1E-7</span></code>.</p></li>
<li><p><strong>calls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- max number of varying calls to perform. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- tolerance for successfull matching. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">1E-21</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>Matching a dummy lattice (not LHC or HLLHC):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_chromaticities</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="kc">None</span><span class="p">,</span>              <span class="c1"># this is not LHC or HLLHC</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;CAS3&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq1_target</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq2_target</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">varied_knobs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ksf&quot;</span><span class="p">,</span> <span class="s2">&quot;ksd&quot;</span><span class="p">],</span>  <span class="c1"># only chroma knobs</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Matching the LHC lattice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_chromaticities</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;lhc&quot;</span><span class="p">,</span>                    <span class="c1"># will find the knobs automatically</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq1_target</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq2_target</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.matching.match_tunes">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.matching.</span></span><span class="sig-name descname"><span class="pre">match_tunes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q1_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varied_knobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-21</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/matching.html#match_tunes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.matching.match_tunes" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<p>Provided with an active <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, will run relevant commands to match tunes to
the desired target values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a wrapper around the <a class="reference internal" href="#pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities" title="pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_tunes_and_chromaticities</span></code></a> function. Refer to its documentation
for usage details.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The matching is always performed with the <code class="docutils literal notranslate"><span class="pre">CHROM</span></code> option on.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>accelerator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- name of the accelerator, used to determmine knobs if <em>variables</em> is not given.
Automatic determination will only work for <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">HLLHC</span></code>.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- name of the sequence you want to perform the matching for.</p></li>
<li><p><strong>q1_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- horizontal tune to match to.</p></li>
<li><p><strong>q2_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- vertical tune to match to.</p></li>
<li><p><strong>varied_knobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables names to <code class="docutils literal notranslate"><span class="pre">VARY</span></code> in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> routine.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- <code class="docutils literal notranslate"><span class="pre">LHC</span></code> specific. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="docutils literal notranslate"><span class="pre">(HL)LHC</span></code> knobs for Telescopic
Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> since <code class="xref py py-obj docutils literal notranslate"><span class="pre">v0.9.0</span></code>.</p></li>
<li><p><strong>run3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC</span></code> Run 3 <code class="xref py py-obj docutils literal notranslate"><span class="pre">*_op</span></code> knobs. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- step size to use when varying knobs. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">1E-7</span></code>.</p></li>
<li><p><strong>calls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- max number of varying calls to perform. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- tolerance for successfull matching. Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">1E-21</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>Matching a dummy lattice (not LHC or HLLHC):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="kc">None</span><span class="p">,</span>              <span class="c1"># this is not LHC or HLLHC</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;CAS3&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q1_target</span><span class="o">=</span><span class="mf">6.335</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q2_target</span><span class="o">=</span><span class="mf">6.29</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">varied_knobs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kqf&quot;</span><span class="p">,</span> <span class="s2">&quot;kqd&quot;</span><span class="p">],</span>  <span class="c1"># only tune knobs</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Matching the LHC lattice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;lhc&quot;</span><span class="p">,</span>                    <span class="c1"># will find the knobs automatically</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q1_target</span><span class="o">=</span><span class="mf">62.31</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q2_target</span><span class="o">=</span><span class="mf">60.32</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.matching.</span></span><span class="sig-name descname"><span class="pre">match_tunes_and_chromaticities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q1_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q2_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq1_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq2_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varied_knobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telescopic_squeeze</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-21</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/matching.html#match_tunes_and_chromaticities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.matching.match_tunes_and_chromaticities" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Provided with an active <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object, will run relevant commands to match tunes
and/or chromaticities. As target values are given, the function expects knob names to be provided,
which are then used and varied by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> to match the targets. This is a convenient wrapper around
the <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> command. For usage details, see the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a>.</p>
<p>One can find example use of this function in the <a class="reference internal" href="../gallery/demo_lattice.html#demo-accelerator-lattice"><span class="std std-ref">lattice plotting</span></a>,
<a class="reference internal" href="../gallery/demo_lhc_rigid_waist_shift.html#demo-rigid-waist-shift"><span class="std std-ref">rigid waist shift</span></a> or <a class="reference internal" href="../gallery/demo_phase_space.html#demo-phase-space"><span class="std std-ref">phase space</span></a> example
galleries.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If target tune values only are provided, then tune matching is performed with the provided knobs.
If target chromaticity values only are provided, then chromaticity matching is performed with the
provided knobs. If targets for both types are provided, then both are matched in a single call with
the provided knobs.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user wishes to perform different matching calls for each, then it is recommended to call this
function as many times as necessary, with the appropriate targets.</p>
<p>For instance, in some cases and machines some prefer to do a tune matching followed by a chromaticity matching,
then followed by a combined matching. In this case the function should be called three times, once with tune
targets and knobs, another time with chromaticity targets and knobs, then a final time with all of the above.
For this, simple wrappers are provided: the <a class="reference internal" href="#pyhdtoolkit.cpymadtools.matching.match_tunes" title="pyhdtoolkit.cpymadtools.matching.match_tunes"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_tunes()</span></code></a> and <a class="reference internal" href="#pyhdtoolkit.cpymadtools.matching.match_chromaticities" title="pyhdtoolkit.cpymadtools.matching.match_chromaticities"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_chromaticities()</span></code></a> functions.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When acting of either the <code class="docutils literal notranslate"><span class="pre">LHC</span></code> or <code class="docutils literal notranslate"><span class="pre">HLLHC</span></code> machines, the accelerator name can be provided and the vary
knobs will be automatically set accordingly to the provided targets. Note that only the relevant knobs are
set, so if tune targets only are provided, then tune knobs only will be used, and not chromaticity knobs.
If explicit knobs are provided, these will always be used. On other machines the knobs should be provided
explicitly, always.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The matching is always performed with the <code class="docutils literal notranslate"><span class="pre">CHROM</span></code> option on.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>accelerator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- name of the accelerator, used to determmine knobs if <em>variables</em> is not given.
Automatic determination will only work for <code class="docutils literal notranslate"><span class="pre">LHC</span></code> and <code class="docutils literal notranslate"><span class="pre">HLLHC</span></code>.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- name of the sequence you want to perform the matching for.</p></li>
<li><p><strong>q1_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- horizontal tune to match to.</p></li>
<li><p><strong>q2_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- vertical tune to match to.</p></li>
<li><p><strong>dq1_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- horizontal chromaticity to match to.</p></li>
<li><p><strong>dq2_target</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- vertical chromaticity to match to.</p></li>
<li><p><strong>varied_knobs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables names to <code class="docutils literal notranslate"><span class="pre">VARY</span></code> in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> routine. An input
could be <code class="docutils literal notranslate"><span class="pre">[&quot;kqf&quot;,</span> <span class="pre">&quot;ksd&quot;,</span> <span class="pre">&quot;kqf&quot;,</span> <span class="pre">&quot;kqd&quot;]</span></code> as they are common names used for quadrupole and sextupole
strengths (focusing / defocusing) in most examples.</p></li>
<li><p><strong>telescopic_squeeze</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- <code class="docutils literal notranslate"><span class="pre">LHC</span></code> specific. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="docutils literal notranslate"><span class="pre">(HL)LHC</span></code> knobs for Telescopic
Squeeze configuration. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> since <code class="xref py py-obj docutils literal notranslate"><span class="pre">v0.9.0</span></code>.</p></li>
<li><p><strong>run3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, uses the <code class="docutils literal notranslate"><span class="pre">LHC</span></code> Run 3 <code class="xref py py-obj docutils literal notranslate"><span class="pre">*_op</span></code> knobs. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- step size to use when varying knobs.</p></li>
<li><p><strong>calls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- max number of varying calls to perform. Defaults to 100.</p></li>
<li><p><strong>tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- tolerance for successfull matching. Defaults to <span class="math notranslate nohighlight">\(10^{-21}\)</span>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>Matching a dummy lattice (not LHC or HLLHC):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes_and_chromaticities</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="kc">None</span><span class="p">,</span>              <span class="c1"># this is not LHC or HLLHC</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;CAS3&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q1_target</span><span class="o">=</span><span class="mf">6.335</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q2_target</span><span class="o">=</span><span class="mf">6.29</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq1_target</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq2_target</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">varied_knobs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;kqf&quot;</span><span class="p">,</span> <span class="s2">&quot;kqd&quot;</span><span class="p">,</span> <span class="s2">&quot;ksf&quot;</span><span class="p">,</span> <span class="s2">&quot;ksd&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Matching the LHC lattice:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">matching</span><span class="o">.</span><span class="n">match_tunes_and_chromaticities</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;lhc&quot;</span><span class="p">,</span>                    <span class="c1"># will find the knobs automatically</span>
<span class="gp">... </span>    <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q1_target</span><span class="o">=</span><span class="mf">62.31</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">q2_target</span><span class="o">=</span><span class="mf">60.32</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq1_target</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">dq2_target</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">telescopic_squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># influences the knobs definition</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.orbit"></span><section id="orbit-handling">
<span id="cpymadtools-orbit"></span><h2>Orbit Handling<a class="headerlink" href="#orbit-handling" title="Permalink to this headline"></a></h2>
<p>Module with functions to perform <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> orbit setup through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object,
mainly for LHC and HLLHC machines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.orbit.correct_lhc_orbit">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.orbit.</span></span><span class="sig-name descname"><span class="pre">correct_lhc_orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbit_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'micado'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/orbit.html#correct_lhc_orbit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.orbit.correct_lhc_orbit" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Routine for orbit correction using <code class="docutils literal notranslate"><span class="pre">MCB.*</span></code> elements in the LHC. This uses the
<code class="docutils literal notranslate"><span class="pre">CORRECT</span></code> command in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> behind the scenes, refer to the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a> for
usage information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- which sequence to use the routine on.</p></li>
<li><p><strong>orbit_tolerance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the tolerance for the correction. Defaults to 1e-14.</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of iterations of the correction to perform.
Defaults to 3.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the method to use for the correction. Defaults to <code class="docutils literal notranslate"><span class="pre">micado</span></code> as in
the <code class="xref py py-obj docutils literal notranslate"><span class="pre">CORRECT</span></code> command.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">CORRECT</span></code>
command, such as <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">ncorr</span></code>, etc.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">correct_lhc_orbit</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="s2">&quot;lhcb1&quot;</span><span class="p">,</span> <span class="n">plane</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.orbit.get_current_orbit_setup">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.orbit.</span></span><span class="sig-name descname"><span class="pre">get_current_orbit_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/orbit.html#get_current_orbit_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.orbit.get_current_orbit_setup" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Get the current values for the (HL)LHC orbit variables. Initial implementation credits go to
<a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> of all orbit variables set, and their values as set in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> globals.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orbit_setup</span> <span class="o">=</span> <span class="n">get_current_orbit_setup</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.orbit.lhc_orbit_variables">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.orbit.</span></span><span class="sig-name descname"><span class="pre">lhc_orbit_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.10)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/orbit.html#lhc_orbit_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.orbit.lhc_orbit_variables" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Get the variable names used for orbit setup in the (HL)LHC. Initial implementation
credits go to <a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> with a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> of all orbit variables, and a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> of additional variables,
that in the default configurations have the same value as another variable.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variables</span><span class="p">,</span> <span class="n">specials</span> <span class="o">=</span> <span class="n">lhc_orbit_variables</span><span class="p">()</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.orbit.setup_lhc_orbit">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.orbit.</span></span><span class="sig-name descname"><span class="pre">setup_lhc_orbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flat'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/orbit.html#setup_lhc_orbit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.orbit.setup_lhc_orbit" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Automated orbit setup for (HL)LHC runs, for some default schemes. It is assumed that at
least sequence and optics files have been called. Initial implementation credits go to
<a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>scheme</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the default scheme to apply, as defined in the <code class="docutils literal notranslate"><span class="pre">LHC_CROSSING_SCHEMES</span></code>
constant. Accepted values are keys of <code class="xref py py-obj docutils literal notranslate"><span class="pre">LHC_CROSSING_SCHEMES</span></code>. Defaults to <em>flat</em>
(every orbit variable to 0).</p></li>
<li><p><strong>**kwargs</strong> -- Any standard crossing scheme variables (<code class="docutils literal notranslate"><span class="pre">on_x1</span></code>, <code class="docutils literal notranslate"><span class="pre">phi_IR1</span></code>, etc). Values
given here override the values in the default scheme configurations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> of all orbit variables set, and their values as set in the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> globals.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orbit_setup</span> <span class="o">=</span> <span class="n">setup_lhc_orbit</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;lhc_top&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.parameters"></span><section id="parameters">
<span id="cpymadtools-parameters"></span><h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline"></a></h2>
<p>Module with functions to fetch or compute different beam and machine parameters
through a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.parameters.query_beam_attributes">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.parameters.</span></span><span class="sig-name descname"><span class="pre">query_beam_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="models.html#pyhdtoolkit.models.madx.MADXBeam" title="pyhdtoolkit.models.madx.MADXBeam"><span class="pre">pyhdtoolkit.models.madx.MADXBeam</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/parameters.html#query_beam_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.parameters.query_beam_attributes" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.12.0.</span></p>
</div>
<p>Returns all <code class="docutils literal notranslate"><span class="pre">BEAM</span></code> attributes from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> process based on the currently defined
beam. If no beam has been defined at function call, then <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> will return all the default
values. See the <a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a>
for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A validated <a class="reference internal" href="models.html#pyhdtoolkit.models.madx.MADXBeam" title="pyhdtoolkit.models.madx.MADXBeam"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MADXBeam</span></code></a> object.</p>
</dd>
</dl>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.ptc"></span><section id="ptc-routines">
<span id="cpymadtools-ptc"></span><h2>PTC Routines<a class="headerlink" href="#ptc-routines" title="Permalink to this headline"></a></h2>
<p>Module with functions to manipulate <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">PTC</span></code> functionality through a
<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.ptc.get_amplitude_detuning">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.ptc.</span></span><span class="sig-name descname"><span class="pre">get_amplitude_detuning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.10)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fringe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/ptc.html#get_amplitude_detuning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.ptc.get_amplitude_detuning" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.0.</span></p>
</div>
<p>Calculates amplitude detuning coefficients via <code class="docutils literal notranslate"><span class="pre">PTC_NORMAL</span></code>, with sensible defaults set for
other relevant <code class="docutils literal notranslate"><span class="pre">PTC</span></code> commands used in the process. The result table is returned as a
<a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>, the headers of which are the contents of the internal <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table.
This is a heavily refactored version of an initial implementation by <a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_CREATE_LAYOUT</span></code> command is issued with <code class="docutils literal notranslate"><span class="pre">model=3</span></code> (<code class="docutils literal notranslate"><span class="pre">SixTrack</span></code> model), <code class="docutils literal notranslate"><span class="pre">method=4</span></code>
(integration order), <code class="docutils literal notranslate"><span class="pre">nst=3</span></code> (number of integration steps, aka body slices for elements) and
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> (use exact Hamiltonian, not an approximated one).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_NORMAL</span></code> command is explicitely given <code class="docutils literal notranslate"><span class="pre">icase=6</span></code> to enforce 6D calculations (see the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a> for details),
<code class="docutils literal notranslate"><span class="pre">no=5</span></code> (map order for derivative evaluation of Twiss parameters), <code class="docutils literal notranslate"><span class="pre">closedorbit=True</span></code> (triggers
closed orbit calculation) and <code class="docutils literal notranslate"><span class="pre">normal=True</span></code> (activate calculation of the Normal Form).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- maximum derivative order coefficient (only 0, 1 or 2 implemented in <code class="docutils literal notranslate"><span class="pre">PTC</span></code>).
Defaults to 2.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[Path,</span> <span class="pre">str]</span></code>) -- path to output file. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>fringe</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- boolean flag to include fringe field effects in the calculation. Defaults to
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument is transmitted to the <code class="docutils literal notranslate"><span class="pre">PTC_NORMAL</span></code> command. See above which
arguments are already set for <code class="docutils literal notranslate"><span class="pre">PTC_NORMAL</span></code> to avoid trying to override them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataframe</span></code> with the calculated coefficients.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ampdet_coeffs</span> <span class="o">=</span> <span class="n">get_amplitude_detuning</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">closedorbit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.ptc.get_rdts">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.ptc.</span></span><span class="sig-name descname"><span class="pre">get_rdts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.10)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fringe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/ptc.html#get_rdts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.ptc.get_rdts" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.7.0.</span></p>
</div>
<p>Calculate the resonance driving terms up to <em>order</em> via <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code>, with sensible defaults
set for other relevant <code class="docutils literal notranslate"><span class="pre">PTC</span></code> commands. The result table is returned as a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>,
the headers of which are the contents of the internal <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table. This is a heavily refactored
version of an initial implementation by <a class="reference external" href="https://github.com/joschd">Joschua Dilly</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_CREATE_LAYOUT</span></code> command is issued with <code class="docutils literal notranslate"><span class="pre">model=3</span></code> (<code class="docutils literal notranslate"><span class="pre">SixTrack</span></code> model), <code class="docutils literal notranslate"><span class="pre">method=4</span></code>
(integration order), <code class="docutils literal notranslate"><span class="pre">nst=3</span></code> (number of integration steps, aka body slices for elements) and
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> (use exact Hamiltonian, not an approximated one).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_NORMAL</span></code> command is explicitely given <code class="docutils literal notranslate"><span class="pre">icase=6</span></code> to enforce 6D calculations (see the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a> for details),
<code class="docutils literal notranslate"><span class="pre">trackrdts=True</span></code> (for this function to fullfill its purpose) and <code class="docutils literal notranslate"><span class="pre">normal=True</span></code> to trigger
saving the normal form analysis results in a table called <code class="docutils literal notranslate"><span class="pre">NONLIN</span></code> which will then be available
through the provided <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> instance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- map order for derivative evaluation of Twiss parameters. Defaults to 4.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[Path,</span> <span class="pre">str]</span></code>) -- path to output file. Default to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>fringe</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- boolean flag to include fringe field effects in the calculation. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument is transmitted to the <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> command. See above which arguments
are already set for <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> to avoid trying to override them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataframe</span></code> with the calculated RDTs.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdts_df</span> <span class="o">=</span> <span class="n">get_rdts</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fringe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.ptc.ptc_track_particle">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.ptc.</span></span><span class="sig-name descname"><span class="pre">ptc_track_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nturns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onetable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fringe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><span class="pre">pandas.core.frame.DataFrame</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/ptc.html#ptc_track_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.ptc.ptc_track_particle" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.12.0.</span></p>
</div>
<p>Tracks a single particle for <em>nturns</em> through <code class="docutils literal notranslate"><span class="pre">PTC_TRACK</span></code>, based on its initial coordinates. The
use of this function is similar to that of <a class="reference internal" href="#pyhdtoolkit.cpymadtools.track.track_single_particle" title="pyhdtoolkit.cpymadtools.track.track_single_particle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">track_single_particle</span></code></a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_CREATE_LAYOUT</span></code> command is issued with <code class="docutils literal notranslate"><span class="pre">model=3</span></code> (<code class="docutils literal notranslate"><span class="pre">SixTrack</span></code> model), <code class="docutils literal notranslate"><span class="pre">method=4</span></code>
(integration order), <code class="docutils literal notranslate"><span class="pre">nst=3</span></code> (number of integration steps, aka body slices for elements) and
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> (use exact Hamiltonian, not an approximated one).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_TRACK</span></code> command is explicitely given <code class="docutils literal notranslate"><span class="pre">ELEMENT_BY_ELEMENT=True</span></code> to force element by
element tracking mode.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the <em>sequence</em> argument is given a string value, the <code class="docutils literal notranslate"><span class="pre">USE</span></code> command will be ran on the provided
sequence name. This means the caveats of <code class="docutils literal notranslate"><span class="pre">USE</span></code> apply, for instance the erasing of previously
defined errors, orbits corrections etc. In this case a warning will be logged but the function will
proceed. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> is given (by default) then the sequence already in use will be the one tracking
is performed on.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instantiated cpymad.madx.Madx object.</p></li>
<li><p><strong>initial_coordinates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float]</span></code>) -- a tuple with the <code class="docutils literal notranslate"><span class="pre">X,</span> <span class="pre">PX,</span>
<span class="pre">Y,</span> <span class="pre">PY,</span> <span class="pre">T,</span> <span class="pre">PT</span></code> starting coordinates of the particle to track. Defaults to all 0 if <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> given.</p></li>
<li><p><strong>nturns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of turns to track for.</p></li>
<li><p><strong>sequence</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- the sequence to use for tracking. If no value is provided, it is assumed
that a sequence is already defined and in use, and this one will be picked up by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.
Beware of the dangers of giving a sequence that will be used by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>, see the warning below
for more information.</p></li>
<li><p><strong>observation_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- sequence of all element names at which to <code class="docutils literal notranslate"><span class="pre">OBSERVE</span></code> during the
tracking.</p></li>
<li><p><strong>onetable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- flag to combine all observation points data into a single table. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>fringe</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- boolean flag to include fringe field effects in the calculation. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> -- <p>Any keyword argument is transmitted to the <code class="docutils literal notranslate"><span class="pre">PTC_TRACK</span></code> command such as the <code class="docutils literal notranslate"><span class="pre">CLOSED_ORBIT</span></code>
flag to activate closed orbit calculation before tracking. Refer to the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a> for options.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> with a copy of the track table’s dataframe for each defined observation point,
with as columns the coordinates <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">px,</span> <span class="pre">y,</span> <span class="pre">py,</span> <span class="pre">t,</span> <span class="pre">pt,</span> <span class="pre">s</span> <span class="pre">and</span> <span class="pre">e</span></code> (energy). The keys of the dictionary
are simply named <code class="docutils literal notranslate"><span class="pre">observation_point_1</span></code>, <code class="docutils literal notranslate"><span class="pre">observation_point_2</span></code> etc. The first observation point
always corresponds to the start of machine, the others correspond to the ones manually defined,
in the order they are defined in.</p>
<p>If the user has set <code class="docutils literal notranslate"><span class="pre">onetable</span></code> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, only one entry is in the dictionary under the key
<code class="docutils literal notranslate"><span class="pre">trackone</span></code> and it has the combined table as a pandas DataFrame for value.</p>
</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tracks_dict</span> <span class="o">=</span> <span class="n">ptc_track_particle</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">nturns</span><span class="o">=</span><span class="mi">1023</span><span class="p">,</span> <span class="n">initial_coordinates</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.ptc.ptc_twiss">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.ptc.</span></span><span class="sig-name descname"><span class="pre">ptc_twiss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.10)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fringe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'ptc_twiss'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/ptc.html#ptc_twiss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.ptc.ptc_twiss" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.12.0.</span></p>
</div>
<p>Calculates the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> parameters according to the <span id="id9">Willeke and Ripken [<a class="reference internal" href="../bibliography.html#id5" title="F. Willeke and G. Ripken. Methods of beam optics. In AIP Conference Proceedings, volume 184, 758–819. FERMILAB/ CORNELL UNIVERSITY, USA, 1989. AIP. ISSN: 0094243X. URL: http://aip.scitation.org/doi/abs/10.1063/1.38050, doi:10.1063/1.38050.">WR89</a>]</span> formalism
via <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code>, with sensible defaults set for other relevant <code class="docutils literal notranslate"><span class="pre">PTC</span></code> commands. The result
table is returned as a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>, the headers of which are the contents of the
internal <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table.</p>
<p>This is very similar to the <a class="reference internal" href="#pyhdtoolkit.cpymadtools.ptc.get_rdts" title="pyhdtoolkit.cpymadtools.ptc.get_rdts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rdts</span></code></a> function as both use <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> internally,
however this function does not track RDTs which makes the calculations significantly faster.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_CREATE_LAYOUT</span></code> command is issued with <code class="docutils literal notranslate"><span class="pre">model=3</span></code> (<code class="docutils literal notranslate"><span class="pre">SixTrack</span></code> model), <code class="docutils literal notranslate"><span class="pre">method=4</span></code>
(integration order), <code class="docutils literal notranslate"><span class="pre">nst=3</span></code> (number of integration steps, aka body slices for elements) and
<code class="docutils literal notranslate"><span class="pre">exact=True</span></code> (use exact Hamiltonian, not an approximated one).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> command is explicitely given <code class="docutils literal notranslate"><span class="pre">icase=6</span></code> to enforce 6D calculations (see the
<a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a> for details),
<code class="docutils literal notranslate"><span class="pre">normal=True</span></code> to trigger saving the normal form analysis results in a table called <code class="docutils literal notranslate"><span class="pre">NONLIN</span></code>
which will then be available through the provided <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> instance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- map order for derivative evaluation of <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> parameters. Defaults to 4.</p></li>
<li><p><strong>file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Union[Path,</span> <span class="pre">str]</span></code>) -- path to output file. Default to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>fringe</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- boolean flag to include fringe field effects in the calculation. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table in which to save the results. Defaults to <strong>ptc_twiss</strong>.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument is transmitted to the <code class="docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> command. See above which arguments
are already set for <code class="xref py py-obj docutils literal notranslate"><span class="pre">PTC_TWISS</span></code> to avoid trying to override them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataframe</span></code> with the calculated <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> parameters.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twiss_ptc_df</span> <span class="o">=</span> <span class="n">ptc_twiss</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.track"></span><section id="tracking-routines">
<span id="cpymadtools-track"></span><h2>Tracking Routines<a class="headerlink" href="#tracking-routines" title="Permalink to this headline"></a></h2>
<p>Module with functions to manipulate <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TRACK</span></code> functionality through a
<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.track.track_single_particle">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.track.</span></span><span class="sig-name descname"><span class="pre">track_single_particle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nturns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.10)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.5.0)"><span class="pre">pandas.core.frame.DataFrame</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/track.html#track_single_particle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.track.track_single_particle" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Tracks a single particle for <em>nturns</em>, based on its initial coordinates. For an example of the use of this
function, have a look at the <a class="reference internal" href="../gallery/demo_phase_space.html#demo-phase-space"><span class="std std-ref">phase space</span></a> or <a class="reference internal" href="../gallery/demo_track_spectra.html#demo-free-tracking"><span class="std std-ref">tracking</span></a>
example galleries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instantiated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>initial_coordinates</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Tuple[float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float,</span> <span class="pre">float]</span></code>) -- a tuple with the <code class="docutils literal notranslate"><span class="pre">X,</span> <span class="pre">PX,</span>
<span class="pre">Y,</span> <span class="pre">PY,</span> <span class="pre">T,</span> <span class="pre">PT</span></code> starting coordinates of the particle to track. Defaults to all 0 if <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> given.</p></li>
<li><p><strong>nturns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- the number of turns to track for.</p></li>
<li><p><strong>sequence</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>) -- the sequence to use for tracking. If no value is provided, it is assumed
that a sequence is already defined and in use, and this one will be picked up by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.
Beware of the dangers of giving a sequence that will be used by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>, see the warning below
for more information.</p></li>
<li><p><strong>observation_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- sequence of all element names at which to <code class="docutils literal notranslate"><span class="pre">OBSERVE</span></code> during the
tracking.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument will be given to the <code class="docutils literal notranslate"><span class="pre">TRACK</span></code> command like it would be given directly
into <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>, for instance <code class="docutils literal notranslate"><span class="pre">ONETABLE</span></code> etc. Refer to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> manual for options.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the <em>sequence</em> argument is given a string value, the <code class="docutils literal notranslate"><span class="pre">USE</span></code> command will be ran on the provided
sequence name. This means the caveats of <code class="docutils literal notranslate"><span class="pre">USE</span></code> apply, for instance the erasing of previously
defined errors, orbits corrections etc. In this case a warning will be logged but the function will
proceed. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> is given (by default) then the sequence already in use will be the one tracking
is performed on.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p>A <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> with a copy of the track table’s dataframe for each defined observation point,
with as columns the coordinates <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">px,</span> <span class="pre">y,</span> <span class="pre">py,</span> <span class="pre">t,</span> <span class="pre">pt,</span> <span class="pre">s</span> <span class="pre">and</span> <span class="pre">e</span></code> (energy). The keys of the dictionary
are simply named <code class="docutils literal notranslate"><span class="pre">observation_point_1</span></code>, <code class="docutils literal notranslate"><span class="pre">observation_point_2</span></code> etc. The first observation point
always corresponds to the start of machine, the others correspond to the ones manually defined,
in the order they are defined in.</p>
<p>If the user has set <code class="docutils literal notranslate"><span class="pre">onetable</span></code> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, only one entry is in the dictionary under the key
<code class="docutils literal notranslate"><span class="pre">trackone</span></code> and it has the combined table as a pandas DataFrame for value.</p>
</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tracks_dict</span> <span class="o">=</span> <span class="n">track_single_particle</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="p">,</span> <span class="n">nturns</span><span class="o">=</span><span class="mi">1023</span><span class="p">,</span> <span class="n">initial_coordinates</span><span class="o">=</span><span class="p">(</span><span class="mf">2e-4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.tune"></span><section id="tune-utilities">
<span id="cpymadtools-tune"></span><h2>Tune Utilities<a class="headerlink" href="#tune-utilities" title="Permalink to this headline"></a></h2>
<p>Module with functions to manipulate to manipulate <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> functionality around the tune through
a <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.tune.get_footprint_lines">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.tune.</span></span><span class="sig-name descname"><span class="pre">get_footprint_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynap_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.10)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><span class="pre">numpy.ndarray</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/tune.html#get_footprint_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.tune.get_footprint_lines" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.12.0.</span></p>
</div>
<p>Provided with the <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> returned by <a class="reference internal" href="#pyhdtoolkit.cpymadtools.tune.make_footprint_table" title="pyhdtoolkit.cpymadtools.tune.make_footprint_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_footprint_table</span></code></a>, determines the
various (Qx, Qy) points needed to plot the footprint data with lines representing the different amplitudes
and angles from starting particles, and returns these in immediately plottable <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is some <em>dark magic</em> stuff I have taken out of very dusty drawers, and I cannot
explain exactly how it works. I also do not know who wrote this initially. Results are not
guaranteed to be correct and should be checked with a quick plot.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dynap_dframe</strong> (<a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tfs.frame.TfsDataFrame</span></code></a>) -- the dynap data frame returned by <a class="reference internal" href="#pyhdtoolkit.cpymadtools.tune.make_footprint_table" title="pyhdtoolkit.cpymadtools.tune.make_footprint_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_footprint_table</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Qx and Qy data points to plot directly, both as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> objects.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dynap_tfs</span> <span class="o">=</span> <span class="n">make_footprint_table</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qxs</span><span class="p">,</span> <span class="n">qys</span> <span class="o">=</span> <span class="n">get_footprint_lines</span><span class="p">(</span><span class="n">dynap_tfs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">qxs</span><span class="p">,</span> <span class="n">qys</span><span class="p">,</span> <span class="s2">&quot;o--&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Tune Footprint from DYNAP Table&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.tune.get_footprint_patches">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.tune.</span></span><span class="sig-name descname"><span class="pre">get_footprint_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynap_dframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://matplotlib.org/stable/api/collections_api.html#matplotlib.collections.PatchCollection" title="(in Matplotlib v3.6.0)"><span class="pre">matplotlib.collections.PatchCollection</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/tune.html#get_footprint_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.tune.get_footprint_patches" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.12.0.</span></p>
</div>
<p>Provided with the <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> returned by <a class="reference internal" href="#pyhdtoolkit.cpymadtools.tune.make_footprint_table" title="pyhdtoolkit.cpymadtools.tune.make_footprint_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_footprint_table</span></code></a>, computes
the polygon patches needed to plot the footprint data, with lines representing the different
amplitudes and angles from starting particles, and returns the <a class="reference external" href="https://matplotlib.org/stable/api/collections_api.html#matplotlib.collections.PatchCollection" title="(in Matplotlib v3.6.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PatchCollection</span></code></a>
with the computed polygons. Initial implementation credits go to <a class="reference external" href="https://github.com/kparasch">Konstantinos Paraschou</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The polygons will have blue edges, except the ones corresponding to the last starting angle particles
(in red) and the last starting amplitude particles (in green).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The internal construction of polygons can be tricky, and you might need to change the <code class="docutils literal notranslate"><span class="pre">ANGLE</span></code>
or <code class="docutils literal notranslate"><span class="pre">AMPLITUDE</span></code> values in <em>dynap_dframe</em> headers.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dynap_dframe</strong> (<a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tfs.frame.TfsDataFrame</span></code></a>) -- the dynap data frame returned by <a class="reference internal" href="#pyhdtoolkit.cpymadtools.tune.make_footprint_table" title="pyhdtoolkit.cpymadtools.tune.make_footprint_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_footprint_table</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <a class="reference external" href="https://matplotlib.org/stable/api/collections_api.html#matplotlib.collections.PatchCollection" title="(in Matplotlib v3.6.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PatchCollection</span></code></a> with the created polygons.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dynap_tfs</span> <span class="o">=</span> <span class="n">make_footprint_table</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">footprint_polygons</span> <span class="o">=</span> <span class="n">get_footprint_patches</span><span class="p">(</span><span class="n">dynap_tfs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axis</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">footprint_polygons</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.tune.make_footprint_table">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.tune.</span></span><span class="sig-name descname"><span class="pre">make_footprint_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dense</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/tune.html#make_footprint_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.tune.make_footprint_table" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Instantiates an ensemble of particles up to the desired bunch <span class="math notranslate nohighlight">\(\sigma\)</span> amplitude to be tracked for
the <code class="docutils literal notranslate"><span class="pre">DYNAP</span></code> command, letting <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> infer their tunes. Particules are instantiated for different angle
variables for each amplitude, creating an ensemble able to represent the tune footprint.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the <code class="docutils literal notranslate"><span class="pre">DYNAP</span></code> command makes use of tracking, your sequence needs to be sliced before calling
this function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) -- the maximum amplitude of the tracked particles, in bunch <span class="math notranslate nohighlight">\(\sigma\)</span>. Defaults
to 5.</p></li>
<li><p><strong>dense</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- if set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, an increased number of particles will be tracked. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- If given, the <code class="docutils literal notranslate"><span class="pre">dynaptune</span></code> table will be exported as a <code class="docutils literal notranslate"><span class="pre">TFS</span></code> file with the provided name.</p></li>
<li><p><strong>cleanup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) -- If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, the <strong>fort.69</strong> and <strong>lyapunov.data</strong> files are cleared before returning the
<code class="docutils literal notranslate"><span class="pre">dynaptune</span></code> table. Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword argument will be transmitted to the <code class="docutils literal notranslate"><span class="pre">DYNAP</span></code> command in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The resulting <code class="docutils literal notranslate"><span class="pre">dynaptune</span></code> table, as a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dynap_dframe</span> <span class="o">=</span> <span class="n">make_footprint_table</span><span class="p">(</span><span class="n">madx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.twiss"></span><section id="twiss-routines">
<span id="cpymadtools-twiss"></span><h2>TWISS Routines<a class="headerlink" href="#twiss-routines" title="Permalink to this headline"></a></h2>
<p>Module with functions to manipulate <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> functionality through a
<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.twiss.get_ips_twiss">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.twiss.</span></span><span class="sig-name descname"><span class="pre">get_ips_twiss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['name',</span> <span class="pre">'s',</span> <span class="pre">'x',</span> <span class="pre">'y',</span> <span class="pre">'l',</span> <span class="pre">'px',</span> <span class="pre">'py',</span> <span class="pre">'betx',</span> <span class="pre">'bety',</span> <span class="pre">'alfx',</span> <span class="pre">'alfy',</span> <span class="pre">'dx',</span> <span class="pre">'dy',</span> <span class="pre">'mux',</span> <span class="pre">'muy',</span> <span class="pre">'r11',</span> <span class="pre">'r12',</span> <span class="pre">'r21',</span> <span class="pre">'r22',</span> <span class="pre">'beta11',</span> <span class="pre">'beta12',</span> <span class="pre">'beta21',</span> <span class="pre">'beta22']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/twiss.html#get_ips_twiss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.twiss.get_ips_twiss" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Quickly get the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table for certain variables at IP locations only. The <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table will be
included as the <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>’s header dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>columns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables to be returned, as columns in the DataFrame.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command, such as <code class="docutils literal notranslate"><span class="pre">chrom</span></code>,
<code class="docutils literal notranslate"><span class="pre">ripken</span></code>, <code class="docutils literal notranslate"><span class="pre">centre</span></code>; or starting coordinates with <code class="docutils literal notranslate"><span class="pre">betx</span></code>, <code class="docutils literal notranslate"><span class="pre">bety</span></code> etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table’s sub-selection.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ips_df</span> <span class="o">=</span> <span class="n">get_ips_twiss</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">chrom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ripken</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.twiss.get_ir_twiss">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.twiss.</span></span><span class="sig-name descname"><span class="pre">get_ir_twiss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['name',</span> <span class="pre">'s',</span> <span class="pre">'x',</span> <span class="pre">'y',</span> <span class="pre">'l',</span> <span class="pre">'px',</span> <span class="pre">'py',</span> <span class="pre">'betx',</span> <span class="pre">'bety',</span> <span class="pre">'alfx',</span> <span class="pre">'alfy',</span> <span class="pre">'dx',</span> <span class="pre">'dy',</span> <span class="pre">'mux',</span> <span class="pre">'muy',</span> <span class="pre">'r11',</span> <span class="pre">'r12',</span> <span class="pre">'r21',</span> <span class="pre">'r22',</span> <span class="pre">'beta11',</span> <span class="pre">'beta12',</span> <span class="pre">'beta21',</span> <span class="pre">'beta22']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/twiss.html#get_ir_twiss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.twiss.get_ir_twiss" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.9.0.</span></p>
</div>
<p>Quickly get the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table for certain variables for one Interaction Region, meaning at the IP and
Q1 to Q3 both left and right of the IP. The <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table will be included as the <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>’s
header dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>ir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) -- which interaction region to get the TWISS for.</p></li>
<li><p><strong>columns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables to be returned, as columns in the DataFrame.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command, such as <code class="docutils literal notranslate"><span class="pre">chrom</span></code>,
<code class="docutils literal notranslate"><span class="pre">ripken</span></code>, <code class="docutils literal notranslate"><span class="pre">centre</span></code>; or starting coordinates with <code class="docutils literal notranslate"><span class="pre">betx</span></code>, <code class="docutils literal notranslate"><span class="pre">bety</span></code> etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table’s sub-selection.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ir_df</span> <span class="o">=</span> <span class="n">get_ir_twiss</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">chrom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ripken</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.twiss.get_pattern_twiss">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.twiss.</span></span><span class="sig-name descname"><span class="pre">get_pattern_twiss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.10)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['']</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/twiss.html#get_pattern_twiss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.twiss.get_pattern_twiss" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.0.</span></p>
</div>
<p>Extracts the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table for desired variables from the provided <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a>
object, and for certain elements matching the provided <em>patterns</em>. The table is returned
as a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>. Additionally, the <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table is also returned as the
headers of the returned DataFrame.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> flag will be fully cleared after running this function.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Although the <em>patterns</em> parameter should accept a regex, <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> does not implement actual regexes.
Please refer to the <a class="reference external" href="http://madx.web.cern.ch/madx/releases/last-rel/madxuguide.pdf">MAD-X manual</a>,
section <code class="xref py py-obj docutils literal notranslate"><span class="pre">Regular</span> <span class="pre">Expressions</span></code> for details on what is implemented in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> itself.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>columns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the variables to be returned, as columns in the <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>.
Defaults to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, which will return all available columns.</p></li>
<li><p><strong>patterns</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence[str]</span></code>) -- the different element patterns (such as <code class="docutils literal notranslate"><span class="pre">MQX</span></code> or <code class="docutils literal notranslate"><span class="pre">BPM</span></code>) to be applied
to the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command, which will determine the rows in the returned <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>.
Defaults to <code class="xref py py-obj docutils literal notranslate"><span class="pre">[&quot;&quot;]</span></code> which will select all elements.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command, such as <code class="docutils literal notranslate"><span class="pre">chrom</span></code>,
<code class="docutils literal notranslate"><span class="pre">ripken</span></code>, <code class="docutils literal notranslate"><span class="pre">centre</span></code>; or starting coordinates with <code class="docutils literal notranslate"><span class="pre">betx</span></code>, <code class="docutils literal notranslate"><span class="pre">bety</span></code> etc.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> with the selected columns for all elements matching the provided patterns,
and the internal <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table as header <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>.</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<p>To get LHC IP points:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ips_df</span> <span class="o">=</span> <span class="n">get_pattern_twiss</span><span class="p">(</span><span class="n">madx</span><span class="o">=</span><span class="n">madx</span><span class="p">,</span> <span class="n">patterns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;IP&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>To get (HL)LHC IR1 triplets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">triplets_df</span> <span class="o">=</span> <span class="n">get_pattern_twiss</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">madx</span><span class="o">=</span><span class="n">madx</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">patterns</span><span class="o">=</span><span class="p">[</span>
<span class="gp">... </span>        <span class="sa">f</span><span class="s2">&quot;MQXA.[12345][RL]1&quot;</span><span class="p">,</span>  <span class="c1"># Q1 and Q3 LHC</span>
<span class="gp">... </span>        <span class="sa">f</span><span class="s2">&quot;MQXB.[AB][12345][RL]1&quot;</span><span class="p">,</span>  <span class="c1"># Q2A and Q2B LHC</span>
<span class="gp">... </span>        <span class="sa">f</span><span class="s2">&quot;MQXF[AB].[AB][12345][RL]1&quot;</span><span class="p">,</span>  <span class="c1"># Q1 to Q3 A and B HL-LHC</span>
<span class="gp">... </span>    <span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.twiss.get_twiss_tfs">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.twiss.</span></span><span class="sig-name descname"><span class="pre">get_twiss_tfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/twiss.html#get_twiss_tfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.twiss.get_twiss_tfs" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.8.3.</span></p>
</div>
<p>Returns a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> from the <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> instance’s <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table,
typically in the way we’re used to getting it from <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> outputting the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TWISS</span></code> (uppercase
names, colnames, <code class="docutils literal notranslate"><span class="pre">SUMM</span></code> table in headers). This will call the <code class="xref py py-obj docutils literal notranslate"><span class="pre">TWISS</span></code> command first before
returning the dframe to you.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>**kwargs</strong> -- Any keyword argument that can be given to the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> command, such as <code class="docutils literal notranslate"><span class="pre">chrom</span></code>,
<code class="docutils literal notranslate"><span class="pre">ripken</span></code>, <code class="docutils literal notranslate"><span class="pre">centre</span></code>; or starting coordinates with <code class="docutils literal notranslate"><span class="pre">betx</span></code>, <code class="docutils literal notranslate"><span class="pre">bety</span></code> etc.    Keyword Args:</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> of the <code class="docutils literal notranslate"><span class="pre">TWISS</span></code> table.</p>
</dd>
</dl>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twiss_df</span> <span class="o">=</span> <span class="n">get_twiss_tfs</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">chrom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ripken</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
<span class="target" id="module-pyhdtoolkit.cpymadtools.utils"></span><section id="miscellaneous-utilities">
<span id="cpymadtools-utils"></span><h2>Miscellaneous Utilities<a class="headerlink" href="#miscellaneous-utilities" title="Permalink to this headline"></a></h2>
<p>Module with utility functions to do mundane operations with <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> objects.</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.utils.export_madx_table">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.utils.</span></span><span class="sig-name descname"><span class="pre">export_madx_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.10)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.10)"><span class="pre">pathlib.Path</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.10)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SUMM'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/utils.html#export_madx_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.utils.export_madx_table" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.17.0.</span></p>
</div>
<p>Exports an internal table from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> process into a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> on disk.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Tables can only be correctly read back in <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> (through <code class="docutils literal notranslate"><span class="pre">READTABLE</span></code>) if the written
file has a <code class="docutils literal notranslate"><span class="pre">NAME</span></code> and a <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> entries in its headers.</p>
<p>If these entries are not  (see below for their usage), then
they will be given default values so the <strong>TFS</strong> file can be read by <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>table_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table to retrieve.</p></li>
<li><p><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the file to export to.</p></li>
<li><p><strong>pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- if given, will be used as a regular expression to filter the extracted
table, by passing it as the <em>regex</em> parameter of <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.filter.html#pandas.DataFrame.filter" title="(in pandas v1.5.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pandas.DataFrame.filter</span></code></a>.</p></li>
<li><p><strong>headers_table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table to use for headers.
Defaults to <code class="docutils literal notranslate"><span class="pre">SUMM</span></code>.</p></li>
<li><p><strong>**kwargs</strong> -- any keyword arguments will be passed to <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.writer.write_tfs" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_tfs</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyhdtoolkit.cpymadtools.utils.get_table_tfs">
<span class="sig-prename descclassname"><span class="pre">pyhdtoolkit.cpymadtools.utils.</span></span><span class="sig-name descname"><span class="pre">get_table_tfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">madx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><span class="pre">cpymad.madx.Madx</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'SUMM'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><span class="pre">tfs.frame.TfsDataFrame</span></a></span></span><a class="reference internal" href="../_modules/pyhdtoolkit/cpymadtools/utils.html#get_table_tfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyhdtoolkit.cpymadtools.utils.get_table_tfs" title="Permalink to this definition"></a></dt>
<dd><div class="versionadded">
<p><span class="versionmodified added">New in version 0.11.0.</span></p>
</div>
<p>Turns an internal table from the <code class="docutils literal notranslate"><span class="pre">MAD-X</span></code> process into a <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>madx</strong> (<a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">cpymad.madx.Madx</span></code></a>) -- an instanciated <a class="reference external" href="https://hibtc.github.io/cpymad/automod/cpymad.madx.Madx.html#cpymad.madx.Madx" title="(in cpymad v1.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Madx</span></code></a> object.</p></li>
<li><p><strong>table_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table to retrieve.</p></li>
<li><p><strong>headers_table</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) -- the name of the internal table to use for headers.
Defaults to <code class="docutils literal notranslate"><span class="pre">SUMM</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference external" href="https://pylhc.github.io/tfs/modules/index.html#tfs.frame.TfsDataFrame" title="(in tfs-pandas v3.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TfsDataFrame</span></code></a> object with the <em>table_name</em> data, and the desired
<em>headers_table</em> (usually <code class="docutils literal notranslate"><span class="pre">SUMM</span></code>) as headers.</p>
</dd>
</dl>
<div class="admonition-examples admonition">
<p class="admonition-title">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">twiss_tfs</span> <span class="o">=</span> <span class="n">get_table_tfs</span><span class="p">(</span><span class="n">madx</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="s2">&quot;TWISS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api.html" class="btn btn-neutral float-left" title="API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="maths.html" class="btn btn-neutral float-right" title="Maths" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Felix Soubelet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: 67.5%; }
  </style>



</body>
</html>